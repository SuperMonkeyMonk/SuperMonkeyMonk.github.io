void function(t){var e={},i={};t.startModule=function(t){require(t).start()},t.define=function(t,i){e[t]=i},t.require=function(t){return/\.js$/.test(t)||(t+=".js"),i[t]?i[t]:i[t]=e[t]({})}}(this),define("scripts/collide.js",function(t){function e(t){return t*t}function i(t){return 0>t?-1:t>0?1:0}function r(t,e,i){if(0!=t){var r=e*e-4*t*i;return 0==r?[-1*e/(2*t),-1*e/(2*t)]:r>0?[(-1*e+Math.sqrt(r))/(2*t),(-1*e-Math.sqrt(r))/(2*t)]:void 0}}function n(t,n,s,o,c){if(!(0>=o)){c=void 0===c?1:c;var u,h=o,l=o*c;if(a=e(l)*e(t[0]-n[0])+e(h)*e(t[1]-n[1]),!(a<=0)&&(b=2*e(l)*(n[0]-t[0])*(t[0]-s[0])+2*e(h)*(n[1]-t[1])*(t[1]-s[1]),s=e(l)*e(t[0]-s[0])+e(h)*e(t[1]-s[1])-e(h)*e(l),u=r(a,b,s,h,l))){var f=[[t[0]+u[0]*(n[0]-t[0]),t[1]+u[0]*(n[1]-t[1])],[t[0]+u[1]*(n[0]-t[0]),t[1]+u[1]*(n[1]-t[1])]];return i(f[0][0]-t[0])*i(f[0][0]-n[0])<=0&&i(f[0][1]-t[1])*i(f[0][1]-n[1])<=0||(f[0]=null),i(f[1][0]-t[0])*i(f[1][0]-n[0])<=0&&i(f[1][1]-t[1])*i(f[1][1]-n[1])<=0||(f[1]=null),f}}}function s(t,e,i,r,s){var o=n(t,e,i,r,s);return o&&(o[0]||o[1])}var o=require("scripts/factory/fruit"),c=(require("scripts/lib/ucren"),o.getFruitInView());return t.check=function(t){var e=[],i=0;return c.forEach(function(r){var n=s(t.slice(0,2),t.slice(2,4),[r.originX,r.originY],r.radius);n&&(e[i++]=r)}),e},t}),define("scripts/control.js",function(t){var e,i,r=require("scripts/lib/ucren"),n=require("scripts/object/knife"),s=require("scripts/message"),o=require("scripts/state");return e=i=0,t.init=function(){this.fixCanvasPos(),this.installDragger(),this.installClicker()},t.installDragger=function(){var t=new r.BasicDrag({type:"calc"});t.on("returnValue",function(t,r,o,a,c){(c=n.through(o-e,a-i))&&s.postMessage(c,"slice")}),t.on("startDrag",function(){n.newKnife()}),t.bind(document.documentElement)},t.installClicker=function(){r.addEvent(document,"click",function(){o("click-enable").ison()&&s.postMessage("click")})},t.fixCanvasPos=function(){var t=document.documentElement,n=function(r){e=(t.clientWidth-640)/2,i=(t.clientHeight-480)/2-40};n(),r.addEvent(window,"resize",n)},t}),define("scripts/game.js",function(t){var e,i,r,n=require("scripts/timeline"),s=require("scripts/lib/ucren"),o=require("scripts/lib/sound"),a=require("scripts/factory/fruit"),c=require("scripts/object/score"),u=require("scripts/message"),h=require("scripts/state"),l=require("scripts/object/lose"),f=require("scripts/object/game-over"),p=require("scripts/object/knife"),d=require("scripts/object/background"),m=require("scripts/object/light"),g=0,v=s.randomNumber,y=2,b=5,x=[],w=function(){if(!(x.length>=y)){var t=v(640),e=v(640),r=600,n=a.create(t,r).shotOut(0,e);x.push(n),i.play(),w()}};return t.start=function(){i=o.create("sound/throw"),r=o.create("sound/boom"),n.setTimeout(function(){h("game-state").set("playing"),e=n.setInterval(w,1e3)},500)},t.gameOver=function(){h("game-state").set("over"),e.stop(),f.show(),g=0,y=2,x.length=0},t.applyScore=function(t){t>y*b&&(y++,b+=50)},t.sliceAt=function(t,e){var i;h("game-state").isnot("playing")||("boom"!=t.type?(t.broken(e),(i=x.indexOf(t))&&x.splice(i,1),c.number(++g),this.applyScore(g)):(r.play(),this.pauseAllFruit(),d.wobble(),m.start(t)))},t.pauseAllFruit=function(){e.stop(),p.pause(),x.invoke("pause")},u.addEventListener("fruit.remove",function(t){var e;(e=x.indexOf(t))>-1&&x.splice(e,1)}),u.addEventListener("fruit.fallOutOfViewer",function(t){h("game-state").isnot("playing")||"boom"!=t.type&&l.showLoseAt(t.originX)}),u.addEventListener("game.over",function(){t.gameOver(),p.switchOn()}),u.addEventListener("overWhiteLight.show",function(){p.endAll();for(var t=x.length-1;t>=0;t--)x[t].remove();d.stop()}),u.addEventListener("click",function(){h("click-enable").off(),f.hide(),u.postMessage("home-menu","sence.switchSence")}),t}),define("scripts/layer.js",function(t){function e(){return e.num=++e.num||2}var i=require("scripts/lib/raphael"),r=require("scripts/lib/ucren"),n={},s={"default":e(),light:e(),knife:e(),fruit:e(),juice:e(),flash:e(),mask:e()};return t.createImage=function(t,e,i,r,n,s){return t=this.getLayer(t),t.image(e,i,r,n,s)},t.createText=function(t,e,i,n,s,o){return t=this.getLayer(t),r.isIe&&(n+=2),t.text(i,n,e).attr({fill:s||"#fff","font-size":o||"14px","font-family":"\u9ed1\u4f53","text-anchor":"start"})},t.getLayer=function(t){var e,o;return t=t||"default",(e=n[t])?e:(o=r.makeElement("div",{"class":"layer",style:"z-index: "+(s[t]||0)+";"}),r.Element("extra").add(o),e=n[t]=i(o,640,480))},t}),define("scripts/main.js",function(t){var e=require("scripts/timeline"),i=require("scripts/tools"),r=require("scripts/sence"),n=require("scripts/lib/ucren"),s=require("scripts/lib/buzz"),o=require("scripts/control"),a=require("scripts/object/console"),c=require("scripts/message"),u=require("scripts/state"),h=require("scripts/game"),l=require("scripts/collide"),f=e.setTimeout.bind(e),p=function(){var t,e=1e3,i=300;return t=function(t){f(function(){a.log(t)},e),e+=i},t.clear=function(){f(a.clear.bind(a),e),e+=i},t}();t.start=function(){[e,r,o].invoke("init"),p("\u6b63\u5728\u542f\u52a8\u6e38\u620f\uff0c\u53ef\u80fd\u8f83\u6162\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85..."),f(function(){p.clear()},1e4),f(r.switchSence.saturate(r,"home-menu"),3e3)},c.addEventListener("slice",function(t){var e,r=l.check(t);r.length&&(e=i.getAngleByRadian(i.pointToRadian(t.slice(0,2),t.slice(2,4))),r.forEach(function(t){c.postMessage(t,e,"slice.at")}))}),c.addEventListener("slice.at",function(t,e){if(!u("sence-state").isnot("ready")){if(u("sence-name").is("game-body"))return void h.sliceAt(t,e);if(u("sence-name").is("home-menu")){if(t.broken(e),t.isHomeMenu)switch(1){case t.isDojoIcon:r.switchSence("dojo-body");break;case t.isNewGameIcon:r.switchSence("game-body");break;case t.isQuitIcon:r.switchSence("quit-body")}}else;}});var d="";return n.isChrome||(d="$\u4e3a\u4e86\u83b7\u5f97\u6700\u4f73\u6d41\u7545\u5ea6\uff0c\u63a8\u8350\u60a8\u4f7f\u7528 <span class='b'>Google Chrome</span> \u4f53\u9a8c\u672c\u6e38\u620f"),s.isSupported()||(d=d.replace("$","\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 &lt;audio&gt \u64ad\u653e\u58f0\u6548\uff0c\u4e14")),d=d.replace("$",""),n.Element("browser").html(d),t}),define("scripts/message.js",function(t){var e=require("scripts/lib/ucren");return t.postMessage=function(t,i){var r=[].slice.call(arguments,0),n=r.length-1;i=r[n],r.slice(0,n),e.dispatch(i,r)},t.addEventListener=function(t,i){e.dispatch(t,i)},t}),define("scripts/sence.js",function(t){var e,i,r,n,s,o=(require("scripts/lib/ucren"),require("scripts/lib/sound")),a=require("scripts/factory/fruit"),c=require("scripts/object/flash"),u=require("scripts/state"),h=require("scripts/message"),l=require("scripts/object/background"),f=require("scripts/object/fps"),p=require("scripts/object/home-mask"),d=require("scripts/object/logo"),m=require("scripts/object/ninja"),g=require("scripts/object/home-desc"),v=require("scripts/object/dojo"),y=require("scripts/object/new-game"),b=require("scripts/object/quit"),x=require("scripts/object/new"),w=require("scripts/object/score"),k=require("scripts/object/lose"),T=require("scripts/game"),E=require("scripts/object/developing"),S=require("scripts/object/game-over"),h=require("scripts/message"),q=require("scripts/timeline"),j=q.setTimeout.bind(q),M=q.setInterval.bind(q);return t.init=function(){n=o.create("sound/menu"),s=o.create("sound/start"),[l,p,d,m,g,v,x,y,b,w,k,E,S,c,f].invoke("set"),M(f.update.bind(f),500)},t.switchSence=function(e){var i=u("sence-name"),r=u("sence-state");if(!i.is(e)){var n=function(){switch(i.set(e),r.set("entering"),e){case"home-menu":this.showMenu(s);break;case"dojo-body":this.showDojo(s);break;case"game-body":this.showNewGame(s);break;case"quit-body":this.showQuit(s)}}.bind(this),s=function(){r.set("ready"),("dojo-body"==e||"quit-body"==e)&&t.switchSence("home-menu")};r.set("exiting"),i.isunset()?n():i.is("home-menu")?this.hideMenu(n):i.is("dojo-body")?this.hideDojo(n):i.is("game-body")?this.hideNewGame(n):i.is("quit-body")&&this.hideQuit(n)}},t.showMenu=function(t){var s=arguments.callee;s.times=++s.times||1;e=a.create("peach",137,333,!0),i=a.create("sandia",330,322,!0),r=a.create("boom",552,367,!0,2500),[e,i,r].forEach(function(t){t.isHomeMenu=1}),e.isDojoIcon=i.isNewGameIcon=r.isQuitIcon=1;var o=[[p,0],[d,0],[m,500],[g,1500],[v,2e3],[y,2e3],[b,2e3],[x,2e3],[e,2e3],[i,2e3],[r,2e3]];o.invoke("show"),[e,i].invoke("rotate",2500),n.play(),j(t,2500)},t.hideMenu=function(t){[x,v,y,b].invoke("hide"),[p,d,m,g].invoke("hide"),[e,i,r].invoke("fallOff",150),n.stop(),j(t,a.getDropTimeSetting())},t.showNewGame=function(t){w.show(),k.show(),T.start(),s.play(),j(t,1e3)},t.hideNewGame=function(t){w.hide(),k.hide(),s.stop(),j(t,1e3)},t.showDojo=function(t){E.show(250),j(t,1500)},t.hideDojo=function(t){j(t,1e3)},t.showQuit=function(t){window.location.href="index.html"},t.hideQuit=function(t){j(t,1e3)},h.addEventListener("sence.switchSence",function(e){t.switchSence(e)}),t}),define("scripts/state.js",function(t){var e=(require("scripts/lib/ucren"),require("scripts/timeline")),i={},r={};return t=function(t){return r[t]?r[t]:r[t]={is:function(e){return i[t]===e},isnot:function(e){return i[t]!==e},ison:function(){return this.is(!0)},isoff:function(){return this.isnot(!0)},isunset:function(){return this.is(void 0)},set:function(e){return i[t]=e},get:function(){return i[t]},on:function(){var t=this;return t.set(!0),{keep:function(i){e.setTimeout(t.set.saturate(t,!1),i)}}},off:function(){var t=this;return t.set(!1),{keep:function(i){e.setTimeout(t.set.saturate(t,!0),i)}}}}}}),define("scripts/timeline.js",function(t){var e=require("scripts/lib/ucren");t.init=function(){var t=this;t.startTime=s(),t.count=0;var e=1;setInterval(function(){t.count++,u(s())},e)},t.createTask=function(t){var e=o(t);return r.unshift(e),n=1,t.recycle&&this.taskList(t.recycle,e),e},t.taskList=function(t,e){return t.clear||(t.clear=function(){for(var t,e=this.length-1;e>=0;e--)t=this[e],t.stop(),this.splice(e,1);return this}),e&&t.unshift(e),t},t.setTimeout=function(t,e){return this.createTask({start:e,duration:0,onTimeStart:t})},t.setInterval=function(t,e){var i=setInterval(t,e);return{stop:function(){clearInterval(i)}}},t.getFPS=function(){var t=s(),e=this.count/(t-this.startTime)*1e3;return this.count>1e3&&(this.count=0,this.startTime=t),e};var e=require("scripts/lib/ucren"),i=[],r=[],n=0,s=function(){return(new Date).getTime()},o=function(t){var i=t.object||{};return t.start=t.start||0,{start:t.start+s(),duration:-1==t.duration?864e5:t.duration,data:t.data?[0].concat(t.data):[0],started:0,object:i,onTimeStart:t.onTimeStart||i.onTimeStart||e.nul,onTimeUpdate:t.onTimeUpdate||i.onTimeUpdate||e.nul,onTimeEnd:t.onTimeEnd||i.onTimeEnd||e.nul,stop:function(){this.stopped=1}}},a=function(t,e){var i=t.data;i[0]=e,t.onTimeUpdate.apply(t.object,i)},c=function(t){t.started||(t.started=1,t.onTimeStart.apply(t.object,t.data.slice(1)),a(t,0))},u=function(t){for(var e,s,o,u,h=i.length;h--;)if(s=i[h],o=s.start,u=s.duration,t>=o){if(s.stopped){i.splice(h,1);continue}c(s),(e=t-o)<u?a(s,e):(a(s,u),s.onTimeEnd.apply(s.object,s.data.slice(1)),i.splice(h,1))}n&&(i.unshift.apply(i,r),r.length=n=0)};return t}),define("scripts/tools.js",function(t){return t.unsetObject=function(t){for(var e in t)t.hasOwnProperty(e)&&"function"==typeof t[e]&&(t[e]=function(){})},t.getAngleByRadian=function(t){return 180*t/Math.PI},t.pointToRadian=function(t,e){var i=Math.PI;if(e[0]===t[0])return e[1]>t[1]?.5*i:1.5*i;if(e[1]===t[1])return e[0]>t[0]?0:i;var r=Math.atan((t[1]-e[1])/(t[0]-e[0]));return e[0]>t[0]&&e[1]<t[1]?r+2*i:e[0]>t[0]&&e[1]>t[1]?r:r+i},t}),define("scripts/factory/displacement.js",function(t){var e=require("scripts/layer"),i=require("scripts/timeline");require("scripts/lib/tween");return t.create=function(t,r,n,s,o,a,c,u,h){var l,f={},p={};"function"==typeof u?p.show=p.hide=u:p=u;var d=function(t,e,r,n,s,o,a,c){i.createTask({start:t,duration:e,object:f,data:[r,n,s,o,a,c],onTimeUpdate:f.onTimeUpdate,onTimeStart:f.onTimeStart,onTimeEnd:f.onTimeEnd,recycle:f.anims})};return f.anims=[],f.set=function(){l=e.createImage("default",t,s,o,r,n)},f.show=function(t){d(t,h,s,o,a,c,p.show,"show")},f.hide=function(){this.anims.clear(),d(0,h,a,c,s,o,p.hide,"hide")},f.onTimeUpdate=function(t,e,i,r,n,s){l.attr({x:s(t,e,r-e,h),y:s(t,i,n-i,h)})},f.onTimeStart=function(){},f.onTimeEnd=function(t,e,i,r,n){"hide"===n&&l.hide()},f},t}),define("scripts/factory/fruit.js",function(t){function e(t){var e=w[t.type],i=e[3];this.type=t.type,this.originX=t.originX,this.originY=t.originY,this.radius=i,this.startX=t.originX,this.startY=t.originY,this.radius=i,this.anims=[],"boom"===this.type&&(this.flame=c.create(this.startX-i+4,this.startY-i+5,t.flameStart||0))}function i(){return 4==m(8)?"boom":k[m(5)]}var r=require("scripts/layer"),n=require("scripts/lib/ucren"),s=require("scripts/timeline"),o=require("scripts/lib/tween"),a=require("scripts/message"),c=require("scripts/object/flame"),u=require("scripts/object/flash"),h=require("scripts/factory/juice"),l=(n.isIe,n.isSafari,o.exponential.co),f=(o.circular,o.linear),p=o.quadratic.ci,d=o.quadratic.co,m=n.randomNumber,g=Math.min,v=function(t,e){return(t+e)/2>>0},y=1200,b=200,x=50,w={boom:["images/fruit/boom.png",66,68,26,0,0,null],peach:["images/fruit/peach.png",62,59,37,-50,0,"#e6c731"],sandia:["images/fruit/sandia.png",98,85,38,-100,0,"#c00"],apple:["images/fruit/apple.png",66,66,31,-54,0,"#c8e925"],banana:["images/fruit/banana.png",126,50,43,90,0,null],basaha:["images/fruit/basaha.png",68,72,32,-135,0,"#c00"]},k=["peach","sandia","apple","banana","basaha"],T=[60,50,40,-40,-50,-60],E=[];return e.prototype.set=function(t){var e=w[this.type],i=this.radius;return this.shadow=r.createImage("fruit","images/shadow.png",this.startX-i,this.startY-i+x,106,77),this.image=r.createImage("fruit",e[0],this.startX-i,this.startY-i,e[1],e[2]),t&&(this.image.hide(),this.shadow.hide()),this},e.prototype.pos=function(t,e){var i=this.radius;this.originX=t,this.originY=e,this.image.attr({x:t-=i,y:e-=i}),this.shadow.attr({x:t,y:e+x}),"boom"===this.type&&this.flame.pos(t+4,e+5),this.fallOffing&&!this.fallOutOfViewerCalled&&e>480+this.radius&&(this.fallOutOfViewerCalled=1,a.postMessage(this,"fruit.fallOutOfViewer"))},e.prototype.show=function(t){s.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onScaling,onTimeStart:this.onShowStart,recycle:this.anims})},e.prototype.hide=function(t){"boom"===this.type&&(this.anims.clear(),this.flame.remove(),s.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd,recycle:this.anims}))},e.prototype.rotate=function(t,e){this.rotateSpeed=e||T[m(6)],s.createTask({start:t,duration:-1,object:this,onTimeUpdate:this.onRotating,recycle:this.anims})},e.prototype.broken=function(t){if(!this.brokend){this.brokend=!0;var e;(e=E.indexOf(this))>-1&&E.splice(e,1),"boom"!==this.type?(u.showAt(this.originX,this.originY,t),h.create(this.originX,this.originY,w[this.type][6]),this.apart(t)):this.hide()}},e.prototype.pause=function(){this.brokend||(this.anims.clear(),"boom"==this.type&&this.flame.remove())},e.prototype.apart=function(t){this.anims.clear(),this.image.hide(),this.shadow.hide(),this.aparted=!0;var e=w[this.type],i=e[0].replace(".png",""),n=this.radius,o=r.createImage.saturate(r,this.startX-n,this.startY-n,e[1],e[2]);t=(t%180+360+e[4])%360,this.bImage1=o("fruit",i+"-1.png"),this.bImage2=o("fruit",i+"-2.png"),[this.bImage1,this.bImage2].invoke("rotate",t),this.apartAngle=t,s.createTask({start:0,duration:y,object:this,onTimeUpdate:this.onBrokenDropUpdate,onTimeStart:this.onBrokenDropStart,onTimeEnd:this.onBrokenDropEnd,recycle:this.anims})},e.prototype.shotOut=function(){var t=[-1,1];return function(e,i){return this.shotOutStartX=this.originX,this.shotOutStartY=this.originY,this.shotOutEndX=v(this.originX,i),this.shotOutEndY=g(this.startY-m(this.startY-100),200),this.fallOffToX=i,s.createTask({start:e,duration:y,object:this,onTimeUpdate:this.onShotOuting,onTimeStart:this.onShotOutStart,onTimeEnd:this.onShotOutEnd,recycle:this.anims}),"boom"!=this.type&&this.rotate(0,(m(180)+90)*t[m(2)]),this}}(),e.prototype.fallOff=function(){var t=[-1,1],e=0;return function(i,r){if(!this.aparted&&!this.brokend){this.fallOffing=1;var n=600;"number"!=typeof r&&(r=this.originX+m(b)*t[e++%2]),this.fallTargetX=r,this.fallTargetY=n,s.createTask({start:i,duration:y,object:this,onTimeUpdate:this.onFalling,onTimeStart:this.onFallStart,onTimeEnd:this.onFallEnd,recycle:this.anims})}}}(),e.prototype.remove=function(){var t;this.anims.clear(),this.image&&(this.image.remove(),this.shadow.remove()),this.bImage1&&(this.bImage1.remove(),this.bImage2.remove()),"boom"===this.type&&this.flame.remove(),(t=E.indexOf(this))>-1&&E.splice(t,1);for(var e in this)"function"==typeof this[e]?this[e]=function(t){return function(){throw new Error("method "+t+" has been removed")}}(e):delete this[e];a.postMessage(this,"fruit.remove")},e.prototype.onShowStart=function(){this.image.show()},e.prototype.onScaling=function(t,e,i,r){this.image.scale(r=l(t,e,i-e,500),r),this.shadow.scale(r,r)},e.prototype.onHideEnd=function(){this.remove()},e.prototype.onRotateStart=function(){},e.prototype.onRotating=function(t){this.image.rotate(this.rotateSpeed*t/1e3%360,!0)},e.prototype.onBrokenDropUpdate=function(t){var e=this.radius;this.bImage1.attr({x:f(t,this.brokenPosX-e,this.brokenTargetX1,y),y:p(t,this.brokenPosY-e,this.brokenTargetY1-this.brokenPosY+e,y)}).rotate(f(t,this.apartAngle,this.bImage1RotateAngle,y),!0),this.bImage2.attr({x:f(t,this.brokenPosX-e,this.brokenTargetX2,y),y:p(t,this.brokenPosY-e,this.brokenTargetY2-this.brokenPosY+e,y)}).rotate(f(t,this.apartAngle,this.bImage2RotateAngle,y),!0)},e.prototype.onBrokenDropStart=function(){this.brokenTargetX1=-(m(b)+75),this.brokenTargetX2=m(b+75),this.brokenTargetY1=600,this.brokenTargetY2=600,this.brokenPosX=this.originX,this.brokenPosY=this.originY,this.bImage1RotateAngle=-m(150)-50,this.bImage2RotateAngle=m(150)+50;for(var t=E.length-1;t>=0;t--)E[t]===this&&E.splice(t,1)},e.prototype.onBrokenDropEnd=function(){this.remove()},e.prototype.onShotOuting=function(t){this.pos(f(t,this.shotOutStartX,this.shotOutEndX-this.shotOutStartX,y),d(t,this.shotOutStartY,this.shotOutEndY-this.shotOutStartY,y))},e.prototype.onShotOutStart=function(){},e.prototype.onShotOutEnd=function(){this.fallOff(0,this.fallOffToX)},e.prototype.onFalling=function(t){this.pos(f(t,this.brokenPosX,this.fallTargetX-this.brokenPosX,y),p(t,this.brokenPosY,this.fallTargetY-this.brokenPosY,y))},e.prototype.onFallStart=function(){this.brokenPosX=this.originX,this.brokenPosY=this.originY},e.prototype.onFallEnd=function(){a.postMessage(this,"fruit.fallOff"),this.remove()},t.create=function(t,r,n,s,o){"number"==typeof t&&(s=n,n=r,r=t,t=i());var a=new e({type:t,originX:r,originY:n,flameStart:o}).set(s);return E.unshift(a),a},t.getFruitInView=function(){return E},t.getDropTimeSetting=function(){return y},t}),define("scripts/factory/juice.js",function(t){function e(t,e,i){this.originX=t,this.originY=e,this.color=i,this.distance=a(200)+100,this.radius=10,this.dir=a(360)*Math.PI/180}var i=require("scripts/lib/ucren"),r=require("scripts/layer").getLayer("juice"),n=require("scripts/timeline"),s=require("scripts/lib/tween"),o=require("scripts/tools"),a=i.randomNumber,c=1500,u=s.exponential.co,h=s.quadratic.co,l=Math.sin,f=Math.cos,p=!0,d=10;return(i.isIe||i.isSafari)&&(d=7),e.prototype.render=function(){this.circle=r.circle(this.originX,this.originY,this.radius).attr({fill:this.color,stroke:"none"})},e.prototype.sputter=function(){n.createTask({start:0,duration:c,object:this,onTimeUpdate:this.onTimeUpdate,onTimeEnd:this.onTimeEnd})},e.prototype.onTimeUpdate=function(t){var e,i,r,n;e=u(t,0,this.distance,c),i=this.originX+e*f(this.dir),r=this.originY+e*l(this.dir)+h(t,0,200,c),n=u(t,1,-1,c),this.circle.attr({cx:i,cy:r}).scale(n,n)},e.prototype.onTimeEnd=function(){this.circle.remove(),o.unsetObject(this)},t.create=p?function(t,e,i){for(var r=0;d>r;r++)this.createOne(t,e,i)}:i.nul,t.createOne=function(t,i,r){if(r){var n=new e(t,i,r);n.render(),n.sputter()}},t}),define("scripts/factory/rotate.js",function(t){var e=require("scripts/layer"),i=require("scripts/timeline"),r=require("scripts/lib/ucren");return t.create=function(t,n,s,o,a,c,u,h){var l,f={},p=[12,-12][r.randomNumber(2)],d=r.randomNumber(360);return f.anims=[],f.set=function(){l=e.createImage("default",t,n,s,o,a).scale(c,c).rotate(d,!0)},f.show=function(t){i.createTask({start:t,duration:h,object:this,data:[c,1],onTimeUpdate:this.onZooming,onTimeEnd:this.onShowEnd,recycle:this.anims})},f.hide=function(t){this.anims.clear(),i.createTask({start:t,duration:h,object:this,data:[1,c],onTimeUpdate:this.onZooming,recycle:this.anims})},f.onShowEnd=function(t){this.anims.clear(),i.createTask({start:0,duration:-1,object:this,onTimeUpdate:f.onRotating,recycle:this.anims})},f.onZooming=function(){var t;return function(e,i,r){l.scale(t=u(e,i,r-i,h),t)}}(),f.onRotating=function(){var t=0,e=d;return function(i,r,n,s){e=(e+(i-t)/1e3*p)%360,l.rotate(e,!0),t=i}}(),f},t}),define("scripts/lib/buzz.js",function(t){var e={defaults:{autoplay:!1,duration:5e3,formats:[],loop:!1,placeholder:"--",preload:"metadata",volume:80},types:{mp3:"audio/mpeg",ogg:"audio/ogg",wav:"audio/wav",aac:"audio/aac",m4a:"audio/x-m4a"},sounds:[],el:document.createElement("audio"),sound:function(t,i){function r(t){for(var e=[],i=t.length-1,r=0;i>=r;r++)e.push({start:t.start(i),end:t.end(i)});return e}function n(t){return t.split(".").pop()}function s(t,i){var r=document.createElement("source");r.src=i,e.types[n(i)]&&(r.type=e.types[n(i)]),t.appendChild(r)}i=i||{};var o=0,a=[],c={},u=e.isSupported();if(this.load=function(){return u?(this.sound.load(),this):this},this.play=function(){return u?(this.sound.play(),this):this},this.togglePlay=function(){return u?(this.sound.paused?this.sound.play():this.sound.pause(),this):this},this.pause=function(){return u?(this.sound.pause(),this):this},this.isPaused=function(){return u?this.sound.paused:null},this.stop=function(){return u?(this.setTime(this.getDuration()),this.sound.pause(),this):this},this.isEnded=function(){return u?this.sound.ended:null},this.loop=function(){return u?(this.sound.loop="loop",this.bind("ended.buzzloop",function(){this.currentTime=0,this.play()}),this):this},this.unloop=function(){return u?(this.sound.removeAttribute("loop"),this.unbind("ended.buzzloop"),this):this},this.mute=function(){return u?(this.sound.muted=!0,this):this},this.unmute=function(){return u?(this.sound.muted=!1,this):this},this.toggleMute=function(){return u?(this.sound.muted=!this.sound.muted,this):this},this.isMuted=function(){return u?this.sound.muted:null},this.setVolume=function(t){return u?(0>t&&(t=0),t>100&&(t=100),this.volume=t,this.sound.volume=t/100,this):this},this.getVolume=function(){return u?this.volume:this},this.increaseVolume=function(t){return this.setVolume(this.volume+(t||1))},this.decreaseVolume=function(t){return this.setVolume(this.volume-(t||1))},this.setTime=function(t){return u?(this.whenReady(function(){this.sound.currentTime=t}),this):this},this.getTime=function(){if(!u)return null;var t=Math.round(100*this.sound.currentTime)/100;return isNaN(t)?e.defaults.placeholder:t},this.setPercent=function(t){return u?this.setTime(e.fromPercent(t,this.sound.duration)):this},this.getPercent=function(){if(!u)return null;var t=Math.round(e.toPercent(this.sound.currentTime,this.sound.duration));return isNaN(t)?e.defaults.placeholder:t},this.setSpeed=function(t){return u?void(this.sound.playbackRate=t):this},this.getSpeed=function(){return u?this.sound.playbackRate:null},this.getDuration=function(){if(!u)return null;var t=Math.round(100*this.sound.duration)/100;return isNaN(t)?e.defaults.placeholder:t},this.getPlayed=function(){return u?r(this.sound.played):null},this.getBuffered=function(){return u?r(this.sound.buffered):null},this.getSeekable=function(){return u?r(this.sound.seekable):null},this.getErrorCode=function(){return u&&this.sound.error?this.sound.error.code:0},this.getErrorMessage=function(){if(!u)return null;switch(this.getErrorCode()){case 1:return"MEDIA_ERR_ABORTED";case 2:return"MEDIA_ERR_NETWORK";case 3:return"MEDIA_ERR_DECODE";case 4:return"MEDIA_ERR_SRC_NOT_SUPPORTED";default:return null}},this.getStateCode=function(){return u?this.sound.readyState:null},this.getStateMessage=function(){if(!u)return null;switch(this.getStateCode()){case 0:return"HAVE_NOTHING";case 1:return"HAVE_METADATA";case 2:return"HAVE_CURRENT_DATA";case 3:return"HAVE_FUTURE_DATA";case 4:return"HAVE_ENOUGH_DATA";default:return null}},this.getNetworkStateCode=function(){return u?this.sound.networkState:null},this.getNetworkStateMessage=function(){if(!u)return null;switch(this.getNetworkStateCode()){case 0:return"NETWORK_EMPTY";case 1:return"NETWORK_IDLE";case 2:return"NETWORK_LOADING";case 3:return"NETWORK_NO_SOURCE";default:return null}},this.set=function(t,e){return u?(this.sound[t]=e,this):this},this.get=function(t){return u?t?this.sound[t]:this.sound:null},this.bind=function(t,e){if(!u)return this;t=t.split(" ");for(var i=this,r=function(t){e.call(i,t)},n=0;n<t.length;n++){var s=t[n],o=s;s=o.split(".")[0],a.push({idx:o,func:r}),this.sound.addEventListener(s,r,!0)}return this},this.unbind=function(t){if(!u)return this;t=t.split(" ");for(var e=0;e<t.length;e++)for(var i=t[e],r=i.split(".")[0],n=0;n<a.length;n++){var s=a[n].idx.split(".");(a[n].idx==i||s[1]&&s[1]==i.replace(".",""))&&(this.sound.removeEventListener(r,a[n].func,!0),a.splice(n,1))}return this},this.bindOnce=function(t,e){if(!u)return this;var i=this;c[o++]=!1,this.bind(o+t,function(){c[o]||(c[o]=!0,e.call(i)),i.unbind(o+t)})},this.trigger=function(t){if(!u)return this;t=t.split(" ");for(var e=0;e<t.length;e++)for(var i=t[e],r=0;r<a.length;r++){var n=a[r].idx.split(".");if(a[r].idx==i||n[0]&&n[0]==i.replace(".","")){var s=document.createEvent("HTMLEvents");s.initEvent(n[0],!1,!0),this.sound.dispatchEvent(s)}}return this},this.fadeTo=function(t,i,r){function n(){setTimeout(function(){t>s&&a.volume<t?(a.setVolume(a.volume+=1),n()):s>t&&a.volume>t?(a.setVolume(a.volume-=1),n()):r instanceof Function&&r.apply(a)},o)}if(!u)return this;i instanceof Function?(r=i,i=e.defaults.duration):i=i||e.defaults.duration;var s=this.volume,o=i/Math.abs(s-t),a=this;return this.play(),this.whenReady(function(){n()}),this},this.fadeIn=function(t,e){return u?this.setVolume(0).fadeTo(100,t,e):this},this.fadeOut=function(t,e){return u?this.fadeTo(0,t,e):this},this.fadeWith=function(t,e){return u?(this.fadeOut(e,function(){this.stop()}),t.play().fadeIn(e),this):this},this.whenReady=function(t){if(!u)return null;var e=this;0===this.sound.readyState?this.bind("canplay.buzzwhenready",function(){t.call(e)}):t.call(e)},u&&t){for(var h in e.defaults)e.defaults.hasOwnProperty(h)&&(i[h]=i[h]||e.defaults[h]);if(this.sound=document.createElement("audio"),t instanceof Array)for(var l in t)t.hasOwnProperty(l)&&s(this.sound,t[l]);else if(i.formats.length)for(var f in i.formats)i.formats.hasOwnProperty(f)&&s(this.sound,t+"."+i.formats[f]);else s(this.sound,t);i.loop&&this.loop(),i.autoplay&&(this.sound.autoplay="autoplay"),i.preload===!0?this.sound.preload="auto":i.preload===!1?this.sound.preload="none":this.sound.preload=i.preload,this.setVolume(i.volume),e.sounds.push(this)}},group:function(t){function e(){for(var e=i(null,arguments),r=e.shift(),n=0;n<t.length;n++)t[n][r].apply(t[n],e)}function i(t,e){return t instanceof Array?t:Array.prototype.slice.call(e)}t=i(t,arguments),this.getSounds=function(){return t},this.add=function(e){e=i(e,arguments);for(var r=0;r<e.length;r++)t.push(e[r])},this.remove=function(e){e=i(e,arguments);for(var r=0;r<e.length;r++)for(var n=0;n<t.length;n++)if(t[n]==e[r]){delete t[n];break}},this.load=function(){return e("load"),this},this.play=function(){return e("play"),this},this.togglePlay=function(){return e("togglePlay"),this},this.pause=function(t){return e("pause",t),this},this.stop=function(){return e("stop"),this},this.mute=function(){return e("mute"),this},this.unmute=function(){return e("unmute"),this},this.toggleMute=function(){return e("toggleMute"),this},this.setVolume=function(t){return e("setVolume",t),this},this.increaseVolume=function(t){return e("increaseVolume",t),this},this.decreaseVolume=function(t){return e("decreaseVolume",t),this},this.loop=function(){return e("loop"),this},this.unloop=function(){return e("unloop"),this},this.setTime=function(t){return e("setTime",t),this},this.setduration=function(t){return e("setduration",t),this},this.set=function(t,i){return e("set",t,i),this},this.bind=function(t,i){return e("bind",t,i),this},this.unbind=function(t){return e("unbind",t),this},this.bindOnce=function(t,i){return e("bindOnce",t,i),this},this.trigger=function(t){return e("trigger",t),this},this.fade=function(t,i,r,n){return e("fade",t,i,r,n),this},this.fadeIn=function(t,i){return e("fadeIn",t,i),this},this.fadeOut=function(t,i){return e("fadeOut",t,i),this}},all:function(){return new e.group(e.sounds)},isSupported:function(){return!!e.el.canPlayType},isOGGSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/ogg; codecs="vorbis"')},isWAVSupported:function(){return!!e.el.canPlayType&&e.el.canPlayType('audio/wav; codecs="1"')},isMP3Supported:function(){return!!e.el.canPlayType&&e.el.canPlayType("audio/mpeg;")},isAACSupported:function(){return!!e.el.canPlayType&&(e.el.canPlayType("audio/x-m4a;")||e.el.canPlayType("audio/aac;"))},toTimer:function(t,e){var i,r,n;return i=Math.floor(t/3600),i=isNaN(i)?"--":i>=10?i:"0"+i,r=e?Math.floor(t/60%60):Math.floor(t/60),r=isNaN(r)?"--":r>=10?r:"0"+r,n=Math.floor(t%60),n=isNaN(n)?"--":n>=10?n:"0"+n,e?i+":"+r+":"+n:r+":"+n},fromTimer:function(t){var e=t.toString().split(":");return e&&3==e.length&&(t=3600*parseInt(e[0],10)+60*parseInt(e[1],10)+parseInt(e[2],10)),e&&2==e.length&&(t=60*parseInt(e[0],10)+parseInt(e[1],10)),t},toPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(100*t/e*r)/r},fromPercent:function(t,e,i){var r=Math.pow(10,i||0);return Math.round(e/100*t*r)/r}};return t=e}),define("scripts/lib/raphael.js",function(t){var e,i={};return function(){function t(){if(t.is(arguments[0],D)){for(var e=arguments[0],i=Kt[x](t,e.splice(0,3+t.is(e[0],P))),r=i.set(),n=0,s=e[N];s>n;n++){var o=e[n]||{};l[d](o.type)&&r[z](i[o.type]().attr(o))}return r}return Kt[x](t,arguments)}function r(){for(var t=[],e=0;32>e;e++)t[e]=(~~(16*C.random()))[X](16);return t[12]=4,t[16]=(3&t[16]|8)[X](16),"r-"+t[A]("")}function n(t,e,i){function r(){var n=Array[p].slice.call(arguments,0),s=n[A]("\u25ba"),o=r.cache=r.cache||{},a=r.count=r.count||[];return o[d](s)?i?i(o[s]):o[s]:(a[N]>=1e3&&delete o[a.shift()],a[z](s),o[s]=t[x](e,n),i?i(o[s]):o[s])}return r}function s(e,i,r,n,s){return s?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+s,i,r-2*s,s,-s,n-2*s,2*s-r,2*s-n):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,i,r,n,-r)}function o(){return this.x+E+this.y}function a(e){return function(i,r,n,s){var o={back:e};return t.is(n,"function")?s=n:o.rot=n,i&&i.constructor==zt&&(i=i.attrs.path),i&&(o.along=i),this.animate(o,r,s)}}function c(t,e,i,r,n,s){function o(t){return((l*t+h)*t+u)*t}function a(t,e){var i=c(t,e);return((d*i+p)*i+f)*i}function c(t,e){var i,r,n,s,a,c;for(n=t,c=0;8>c;c++){if(s=o(n)-t,O(s)<e)return n;if(a=(3*l*n+2*h)*n+u,O(a)<1e-6)break;n-=s/a}if(i=0,r=1,n=t,i>n)return i;if(n>r)return r;for(;r>i;){if(s=o(n),O(s-t)<e)return n;t>s?i=n:r=n,n=(r-i)/2+i}return n}var u=3*e,h=3*(r-e)-u,l=1-u-h,f=3*i,p=3*(n-i)-f,d=1-f-p;return a(t,1/(200*s))}t.version="1.5.2";var u,h=/[, ]+/,l={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},f=/\{(\d+)\}/g,p="prototype",d="hasOwnProperty",m=document,g=i,v={was:Object[p][d].call(g,"Raphael"),is:g.Raphael},y=function(){this.customAttributes={}},b="appendChild",x="apply",w="concat",k="createTouch"in m,T="",E=" ",S=String,q="split",j="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[q](E),M={
mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},A="join",N="length",U=S[p].toLowerCase,C=Math,I=C.max,_=C.min,O=C.abs,B=C.pow,L=C.PI,P="number",R="string",D="array",X="toString",Y="fill",V=Object[p][X],z="push",G=/^url\(['"]?([^\)]+?)['"]?\)$/i,H=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,F={NaN:1,Infinity:1,"-Infinity":1},W=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,Z=C.round,$="setAttribute",Q=parseFloat,K=parseInt,J=" progid:DXImageTransform.Microsoft",tt=S[p].toUpperCase,et={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},it={along:"along",blur:P,"clip-rect":"csv",cx:P,cy:P,fill:"colour","fill-opacity":P,"font-size":P,height:P,opacity:P,path:"path",r:P,rotation:"csv",rx:P,ry:P,scale:"csv",stroke:"colour","stroke-opacity":P,"stroke-width":P,translation:"csv",width:P,x:P,y:P},rt="replace",nt=/^(from|to|\d+%?)$/,st=/\s*,\s*/,ot={hs:1,rg:1},at=/,?([achlmqrstvxz]),?/gi,ct=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,ut=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,ht=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,lt=function(t,e){return t.key-e.key};if(t.type=g.SVGAngle||m.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ft,pt=m.createElement("div");if(pt.innerHTML='<v:shape adj="1"/>',ft=pt.firstChild,ft.style.behavior="url(#default#VML)",!ft||"object"!=typeof ft.adj)return t.type=null;pt=null}t.svg=!(t.vml="VML"==t.type),y[p]=t[p],u=y[p],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=U.call(e),"finite"==e?!F[d](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||V.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,i,r,n,s,o){if(null==s){var a=e-r,c=i-n;return a||c?(180*(0>a)+180*C.atan(-c/-a)/L+360)%360:0}return t.angle(e,i,s,o)-t.angle(r,n,s,o)},t.rad=function(t){return t%360*L/180},t.deg=function(t){return 180*t/L%360},t.snapTo=function(e,i,r){if(r=t.is(r,"finite")?r:10,t.is(e,D)){for(var n=e.length;n--;)if(O(e[n]-i)<=r)return e[n]}else{e=+e;var s=i%e;if(r>s)return i-s;if(s>e-r)return i-s+e}return i},t.setWindow=function(t){g=t,m=g.document};var dt=function(t){if(s.vml){var e,i=/^\s+|\s+$/g;try{var r=new ActiveXObject("htmlfile");r.write("<body>"),r.close(),e=r.body}catch(s){e=createPopup().document.body}var o=e.createTextRange();dt=n(function(t){try{e.style.color=S(t)[rt](i,T);var r=o.queryCommandValue("ForeColor");return r=(255&r)<<16|65280&r|(16711680&r)>>>16,"#"+("000000"+r[X](16)).slice(-6)}catch(t){return"none"}})}else{var a=m.createElement("i");a.title="Rapha\xebl Colour Picker",a.style.display="none",m.body[b](a),dt=n(function(t){return a.style.color=t,m.defaultView.getComputedStyle(a,T).getPropertyValue("color")})}return dt(t)},mt=function(){return"hsb("+[this.h,this.s,this.b]+")"},gt=function(){return"hsl("+[this.h,this.s,this.l]+")"},vt=function(){return this.hex};t.hsb2rgb=function(e,i,r,n){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(r=e.b,i=e.s,e=e.h,n=e.o),t.hsl2rgb(e,i,r/2,n)},t.hsl2rgb=function(e,i,r,n){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(r=e.l,i=e.s,e=e.h),(e>1||i>1||r>1)&&(e/=360,i/=100,r/=100);var s,o,a,c={},u=["r","g","b"];if(i){s=.5>r?r*(1+i):r+i-r*i,o=2*r-s;for(var h=0;3>h;h++)a=e+1/3*-(h-1),0>a&&a++,a>1&&a--,1>6*a?c[u[h]]=o+6*(s-o)*a:1>2*a?c[u[h]]=s:2>3*a?c[u[h]]=o+(s-o)*(2/3-a)*6:c[u[h]]=o}else c={r:r,g:r,b:r};return c.r*=255,c.g*=255,c.b*=255,c.hex="#"+(16777216|c.b|c.g<<8|c.r<<16).toString(16).slice(1),t.is(n,"finite")&&(c.opacity=n),c.toString=vt,c},t.rgb2hsb=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,R)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var s,o,a=I(e,i,r),c=_(e,i,r),u=a;if(c==a)return{h:0,s:0,b:a,toString:mt};var h=a-c;return o=h/a,s=e==a?(i-r)/h:i==a?2+(r-e)/h:4+(e-i)/h,s/=6,0>s&&s++,s>1&&s--,{h:s,s:o,b:u,toString:mt}},t.rgb2hsl=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,R)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var s,o,a,c=I(e,i,r),u=_(e,i,r),h=(c+u)/2;if(u==c)a={h:0,s:0,l:h};else{var l=c-u;o=.5>h?l/(c+u):l/(2-c-u),s=e==c?(i-r)/l:i==c?2+(r-e)/l:4+(e-i)/l,s/=6,0>s&&s++,s>1&&s--,a={h:s,s:o,l:h}}return a.toString=gt,a},t._path2string=function(){return this.join(",")[rt](at,"$1")},t.getRGB=n(function(e){if(!e||(e=S(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(ot[d](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=dt(e));var i,r,n,s,o,a,c=e.match(H);return c?(c[2]&&(n=K(c[2].substring(5),16),r=K(c[2].substring(3,5),16),i=K(c[2].substring(1,3),16)),c[3]&&(n=K((o=c[3].charAt(3))+o,16),r=K((o=c[3].charAt(2))+o,16),i=K((o=c[3].charAt(1))+o,16)),c[4]&&(a=c[4][q](st),i=Q(a[0]),"%"==a[0].slice(-1)&&(i*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(s=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100)),c[5]?(a=c[5][q](st),i=Q(a[0]),"%"==a[0].slice(-1)&&(i*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),("deg"==a[0].slice(-3)||"\xb0"==a[0].slice(-1))&&(i/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(s=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100),t.hsb2rgb(i,r,n,s)):c[6]?(a=c[6][q](st),i=Q(a[0]),"%"==a[0].slice(-1)&&(i*=2.55),r=Q(a[1]),"%"==a[1].slice(-1)&&(r*=2.55),n=Q(a[2]),"%"==a[2].slice(-1)&&(n*=2.55),("deg"==a[0].slice(-3)||"\xb0"==a[0].slice(-1))&&(i/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(s=Q(a[3])),a[3]&&"%"==a[3].slice(-1)&&(s/=100),t.hsl2rgb(i,r,n,s)):(c={r:i,g:r,b:n},c.hex="#"+(16777216|n|r<<8|i<<16).toString(16).slice(1),t.is(s,"finite")&&(c.opacity=s),c)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=n(function(e){if(!e)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return t.is(e,D)&&t.is(e[0],D)&&(r=bt(e)),r[N]||S(e)[rt](ct,function(t,e,n){var s=[],o=U.call(e);for(n[rt](ut,function(t,e){e&&s[z](+e)}),"m"==o&&s[N]>2&&(r[z]([e][w](s.splice(0,2))),o="l",e="m"==e?"l":"L");s[N]>=i[o]&&(r[z]([e][w](s.splice(0,i[o]))),i[o]););}),r[X]=t._path2string,r}),t.findDotsAtSegment=function(t,e,i,r,n,s,o,a,c){var u=1-c,h=B(u,3)*t+3*B(u,2)*c*i+3*u*c*c*n+B(c,3)*o,l=B(u,3)*e+3*B(u,2)*c*r+3*u*c*c*s+B(c,3)*a,f=t+2*c*(i-t)+c*c*(n-2*i+t),p=e+2*c*(r-e)+c*c*(s-2*r+e),d=i+2*c*(n-i)+c*c*(o-2*n+i),m=r+2*c*(s-r)+c*c*(a-2*s+r),g=(1-c)*t+c*i,v=(1-c)*e+c*r,y=(1-c)*n+c*o,b=(1-c)*s+c*a,x=90-180*C.atan((f-d)/(p-m))/L;return(f>d||m>p)&&(x+=180),{x:h,y:l,m:{x:f,y:p},n:{x:d,y:m},start:{x:g,y:v},end:{x:y,y:b},alpha:x}};var yt=n(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=jt(t);for(var e,i=0,r=0,n=[],s=[],o=0,a=t[N];a>o;o++)if(e=t[o],"M"==e[0])i=e[1],r=e[2],n[z](i),s[z](r);else{var c=qt(i,r,e[1],e[2],e[3],e[4],e[5],e[6]);n=n[w](c.min.x,c.max.x),s=s[w](c.min.y,c.max.y),i=e[5],r=e[6]}var u=_[x](0,n),h=_[x](0,s);return{x:u,y:h,width:I[x](0,n)-u,height:I[x](0,s)-h}}),bt=function(e){var i=[];t.is(e,D)&&t.is(e&&e[0],D)||(e=t.parsePathString(e));for(var r=0,n=e[N];n>r;r++){i[r]=[];for(var s=0,o=e[r][N];o>s;s++)i[r][s]=e[r][s]}return i[X]=t._path2string,i},xt=n(function(e){t.is(e,D)&&t.is(e&&e[0],D)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,o=0,a=0;"M"==e[0][0]&&(r=e[0][1],n=e[0][2],s=r,o=n,a++,i[z](["M",r,n]));for(var c=a,u=e[N];u>c;c++){var h=i[c]=[],l=e[c];if(l[0]!=U.call(l[0]))switch(h[0]=U.call(l[0]),h[0]){case"a":h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=+(l[6]-r).toFixed(3),h[7]=+(l[7]-n).toFixed(3);break;case"v":h[1]=+(l[1]-n).toFixed(3);break;case"m":s=l[1],o=l[2];default:for(var f=1,p=l[N];p>f;f++)h[f]=+(l[f]-(f%2?r:n)).toFixed(3)}else{h=i[c]=[],"m"==l[0]&&(s=l[1]+r,o=l[2]+n);for(var d=0,m=l[N];m>d;d++)i[c][d]=l[d]}var g=i[c][N];switch(i[c][0]){case"z":r=s,n=o;break;case"h":r+=+i[c][g-1];break;case"v":n+=+i[c][g-1];break;default:r+=+i[c][g-2],n+=+i[c][g-1]}}return i[X]=t._path2string,i},0,bt),wt=n(function(e){t.is(e,D)&&t.is(e&&e[0],D)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,o=0,a=0;"M"==e[0][0]&&(r=+e[0][1],n=+e[0][2],s=r,o=n,a++,i[0]=["M",r,n]);for(var c=a,u=e[N];u>c;c++){var h=i[c]=[],l=e[c];if(l[0]!=tt.call(l[0]))switch(h[0]=tt.call(l[0]),h[0]){case"A":h[1]=l[1],h[2]=l[2],h[3]=l[3],h[4]=l[4],h[5]=l[5],h[6]=+(l[6]+r),h[7]=+(l[7]+n);break;case"V":h[1]=+l[1]+n;break;case"H":h[1]=+l[1]+r;break;case"M":s=+l[1]+r,o=+l[2]+n;default:for(var f=1,p=l[N];p>f;f++)h[f]=+l[f]+(f%2?r:n)}else for(var d=0,m=l[N];m>d;d++)i[c][d]=l[d];switch(h[0]){case"Z":r=s,n=o;break;case"H":r=h[1];break;case"V":n=h[1];break;case"M":s=i[c][i[c][N]-2],o=i[c][i[c][N]-1];default:r=i[c][i[c][N]-2],n=i[c][i[c][N]-1]}}return i[X]=t._path2string,i},null,bt),kt=function(t,e,i,r){return[t,e,i,r,i,r]},Tt=function(t,e,i,r,n,s){var o=1/3,a=2/3;return[o*t+a*i,o*e+a*r,o*n+a*i,o*s+a*r,n,s]},Et=function(t,e,i,r,s,o,a,c,u,h){var l,f=120*L/180,p=L/180*(+s||0),d=[],m=n(function(t,e,i){var r=t*C.cos(i)-e*C.sin(i),n=t*C.sin(i)+e*C.cos(i);return{x:r,y:n}});if(h)S=h[0],j=h[1],T=h[2],E=h[3];else{l=m(t,e,-p),t=l.x,e=l.y,l=m(c,u,-p),c=l.x,u=l.y;var g=(C.cos(L/180*s),C.sin(L/180*s),(t-c)/2),v=(e-u)/2,y=g*g/(i*i)+v*v/(r*r);y>1&&(y=C.sqrt(y),i=y*i,r=y*r);var b=i*i,x=r*r,k=(o==a?-1:1)*C.sqrt(O((b*x-b*v*v-x*g*g)/(b*v*v+x*g*g))),T=k*i*v/r+(t+c)/2,E=k*-r*g/i+(e+u)/2,S=C.asin(((e-E)/r).toFixed(9)),j=C.asin(((u-E)/r).toFixed(9));S=T>t?L-S:S,j=T>c?L-j:j,0>S&&(S=2*L+S),0>j&&(j=2*L+j),a&&S>j&&(S-=2*L),!a&&j>S&&(j-=2*L)}var M=j-S;if(O(M)>f){var U=j,I=c,_=u;j=S+f*(a&&j>S?1:-1),c=T+i*C.cos(j),u=E+r*C.sin(j),d=Et(c,u,i,r,s,0,a,I,_,[j,U,T,E])}M=j-S;var B=C.cos(S),P=C.sin(S),R=C.cos(j),D=C.sin(j),X=C.tan(M/4),Y=4/3*i*X,V=4/3*r*X,z=[t,e],G=[t+Y*P,e-V*B],H=[c+Y*D,u-V*R],F=[c,u];if(G[0]=2*z[0]-G[0],G[1]=2*z[1]-G[1],h)return[G,H,F][w](d);d=[G,H,F][w](d)[A]()[q](",");for(var W=[],Z=0,$=d[N];$>Z;Z++)W[Z]=Z%2?m(d[Z-1],d[Z],p).y:m(d[Z],d[Z+1],p).x;return W},St=function(t,e,i,r,n,s,o,a,c){var u=1-c;return{x:B(u,3)*t+3*B(u,2)*c*i+3*u*c*c*n+B(c,3)*o,y:B(u,3)*e+3*B(u,2)*c*r+3*u*c*c*s+B(c,3)*a}},qt=n(function(t,e,i,r,n,s,o,a){var c,u=n-2*i+t-(o-2*n+i),h=2*(i-t)-2*(n-i),l=t-i,f=(-h+C.sqrt(h*h-4*u*l))/2/u,p=(-h-C.sqrt(h*h-4*u*l))/2/u,d=[e,a],m=[t,o];return O(f)>"1e12"&&(f=.5),O(p)>"1e12"&&(p=.5),f>0&&1>f&&(c=St(t,e,i,r,n,s,o,a,f),m[z](c.x),d[z](c.y)),p>0&&1>p&&(c=St(t,e,i,r,n,s,o,a,p),m[z](c.x),d[z](c.y)),u=s-2*r+e-(a-2*s+r),h=2*(r-e)-2*(s-r),l=e-r,f=(-h+C.sqrt(h*h-4*u*l))/2/u,p=(-h-C.sqrt(h*h-4*u*l))/2/u,O(f)>"1e12"&&(f=.5),O(p)>"1e12"&&(p=.5),f>0&&1>f&&(c=St(t,e,i,r,n,s,o,a,f),m[z](c.x),d[z](c.y)),p>0&&1>p&&(c=St(t,e,i,r,n,s,o,a,p),m[z](c.x),d[z](c.y)),{min:{x:_[x](0,m),y:_[x](0,d)},max:{x:I[x](0,m),y:I[x](0,d)}}}),jt=n(function(t,e){for(var i=wt(t),r=e&&wt(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=(function(t,e){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][w](Et[x](0,[e.x,e.y][w](t.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),r=e.y+(e.y-(e.by||e.y)),t=["C",i,r][w](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][w](Tt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][w](Tt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][w](kt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][w](kt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][w](kt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][w](kt(e.x,e.y,e.X,e.Y))}return t}),a=function(t,e){if(t[e][N]>7){t[e].shift();for(var n=t[e];n[N];)t.splice(e++,0,["C"][w](n.splice(0,6)));t.splice(e,1),h=I(i[N],r&&r[N]||0)}},c=function(t,e,n,s,o){t&&e&&"M"==t[o][0]&&"M"!=e[o][0]&&(e.splice(o,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=t[o][1],n.y=t[o][2],h=I(i[N],r&&r[N]||0))},u=0,h=I(i[N],r&&r[N]||0);h>u;u++){i[u]=o(i[u],n),a(i,u),r&&(r[u]=o(r[u],s)),r&&a(r,u),c(i,r,n,s,u),c(r,i,s,n,u);var l=i[u],f=r&&r[u],p=l[N],d=r&&f[N];n.x=l[p-2],n.y=l[p-1],n.bx=Q(l[p-4])||n.x,n.by=Q(l[p-3])||n.y,s.bx=r&&(Q(f[d-4])||s.x),s.by=r&&(Q(f[d-3])||s.y),s.x=r&&f[d-2],s.y=r&&f[d-1]}return r?[i,r]:i},null,bt),Mt=n(function(e){for(var i=[],r=0,n=e[N];n>r;r++){var s={},o=e[r].match(/^([^:]*):?([\d\.]*)/);if(s.color=t.getRGB(o[1]),s.color.error)return null;s.color=s.color.hex,o[2]&&(s.offset=o[2]+"%"),i[z](s)}for(r=1,n=i[N]-1;n>r;r++)if(!i[r].offset){for(var a=Q(i[r-1].offset||0),c=0,u=r+1;n>u;u++)if(i[u].offset){c=i[u].offset;break}c||(c=100,u=n),c=Q(c);for(var h=(c-a)/(u-r+1);u>r;r++)a+=h,i[r].offset=a+"%"}return i}),At=function(e,i,r,n){var s;return t.is(e,R)||t.is(e,"object")?(s=t.is(e,R)?m.getElementById(e):e,s.tagName?null==i?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:i,height:r}:void 0):{container:1,x:e,y:i,width:r,height:n}},Nt=function(t,e){var i=this;for(var r in e)if(e[d](r)&&!(r in t))switch(typeof e[r]){case"function":!function(e){t[r]=t===i?e:function(){return e[x](i,arguments)}}(e[r]);break;case"object":t[r]=t[r]||{},Nt.call(this,t[r],e[r]);break;default:t[r]=e[r]}},Ut=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},Ct=function(t,e){e.top!==t&&(Ut(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},It=function(t,e){e.bottom!==t&&(Ut(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},_t=function(t,e,i){Ut(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},Ot=function(t,e,i){Ut(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},Bt=function(t){return function(){throw new Error("Rapha\xebl: you are calling to method \u201c"+t+"\u201d of removed object")}};if(t.pathToRelative=xt,t.svg){u.svgns="http://www.w3.org/2000/svg",u.xlink="http://www.w3.org/1999/xlink",Z=function(t){return+t+.5*(~~t===t)};var Lt=function(t,e){if(!e)return t=m.createElementNS(u.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in e)e[d](i)&&t[$](i,S(e[i]))};t[X]=function(){return"Your browser supports SVG.\nYou are running Rapha\xebl "+this.version};var Pt=function(t,e){var i=Lt("path");e.canvas&&e.canvas[b](i);var r=new zt(i,e);return r.type="path",Xt(r,{fill:"none",stroke:"#000",path:t}),r},Rt=function(t,e,i){var n="linear",s=.5,o=.5,a=t.style;if(e=S(e)[rt](ht,function(t,e,i){if(n="radial",e&&i){s=Q(e),o=Q(i);var r=2*(o>.5)-1;B(s-.5,2)+B(o-.5,2)>.25&&(o=C.sqrt(.25-B(s-.5,2))*r+.5)&&.5!=o&&(o=o.toFixed(5)-1e-5*r)}return T}),e=e[q](/\s*\-\s*/),"linear"==n){var c=e.shift();if(c=-Q(c),isNaN(c))return null;var u=[0,0,C.cos(c*L/180),C.sin(c*L/180)],h=1/(I(O(u[2]),O(u[3]))||1);u[2]*=h,u[3]*=h,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var l=Mt(e);if(!l)return null;var f=t.getAttribute(Y);f=f.match(/^url\(#(.*)\)$/),f&&i.defs.removeChild(m.getElementById(f[1]));var p=Lt(n+"Gradient");p.id=r(),Lt(p,"radial"==n?{fx:s,fy:o}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3]}),i.defs[b](p);for(var d=0,g=l[N];g>d;d++){var v=Lt("stop");Lt(v,{offset:l[d].offset?l[d].offset:d?"100%":"0%","stop-color":l[d].color||"#fff"}),p[b](v)}return Lt(t,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1}),a.fill=T,a.opacity=1,a.fillOpacity=1,1},Dt=function(e){var i=e.getBBox();Lt(e.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Xt=function(e,i){var n={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},s=e.node,o=e.attrs,a=e.rotate(),c=function(t,e){if(e=n[U.call(e)]){for(var r=t.attrs["stroke-width"]||"1",o={round:r,square:r,butt:0}[t.attrs["stroke-linecap"]||i["stroke-linecap"]]||0,a=[],c=e[N];c--;)a[c]=e[c]*r+(c%2?1:-1)*o;Lt(s,{"stroke-dasharray":a[A](",")})}};i[d]("rotation")&&(a=i.rotation);var u=S(a)[q](h);u.length-1?(u[1]=+u[1],u[2]=+u[2]):u=null,Q(a)&&e.rotate(0,!0);for(var l in i)if(i[d](l)){if(!et[d](l))continue;var f=i[l];switch(o[l]=f,l){case"blur":e.blur(f);break;case"rotation":e.rotate(f,!0);break;case"href":case"title":case"target":var p=s.parentNode;if("a"!=U.call(p.tagName)){var g=Lt("a");p.insertBefore(g,s),g[b](s),p=g}"target"==l&&"blank"==f?p.setAttributeNS(e.paper.xlink,"show","new"):p.setAttributeNS(e.paper.xlink,l,f);break;case"cursor":s.style.cursor=f;break;case"clip-rect":var v=S(f)[q](h);if(4==v[N]){e.clip&&e.clip.parentNode.parentNode.removeChild(e.clip.parentNode);var y=Lt("clipPath"),x=Lt("rect");y.id=r(),Lt(x,{x:v[0],y:v[1],width:v[2],height:v[3]}),y[b](x),e.paper.defs[b](y),Lt(s,{"clip-path":"url(#"+y.id+")"}),e.clip=x}if(!f){var w=m.getElementById(s.getAttribute("clip-path")[rt](/(^url\(#|\)$)/g,T));w&&w.parentNode.removeChild(w),Lt(s,{"clip-path":T}),delete e.clip}break;case"path":"path"==e.type&&Lt(s,{d:f?o.path=wt(f):"M0,0"});break;case"width":if(s[$](l,f),!o.fx)break;l="x",f=o.x;case"x":o.fx&&(f=-o.x-(o.width||0));case"rx":if("rx"==l&&"rect"==e.type)break;case"cx":u&&("x"==l||"cx"==l)&&(u[1]+=f-o[l]),s[$](l,f),e.pattern&&Dt(e);break;case"height":if(s[$](l,f),!o.fy)break;l="y",f=o.y;case"y":o.fy&&(f=-o.y-(o.height||0));case"ry":if("ry"==l&&"rect"==e.type)break;case"cy":u&&("y"==l||"cy"==l)&&(u[2]+=f-o[l]),s[$](l,f),e.pattern&&Dt(e);break;case"r":"rect"==e.type?Lt(s,{rx:f,ry:f}):s[$](l,f);break;case"src":"image"==e.type&&s.setAttributeNS(e.paper.xlink,"href",f);break;case"stroke-width":s.style.strokeWidth=f,s[$](l,f),o["stroke-dasharray"]&&c(e,o["stroke-dasharray"]);break;case"stroke-dasharray":c(e,f);break;case"translation":var k=S(f)[q](h);k[0]=+k[0]||0,k[1]=+k[1]||0,u&&(u[1]+=k[0],u[2]+=k[1]),Me.call(e,k[0],k[1]);break;case"scale":k=S(f)[q](h),e.scale(+k[0]||1,+k[1]||+k[0]||1,isNaN(Q(k[2]))?null:+k[2],isNaN(Q(k[3]))?null:+k[3]);break;case Y:var j=S(f).match(G);if(j){y=Lt("pattern");var M=Lt("image");y.id=r(),Lt(y,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),Lt(M,{x:0,y:0}),M.setAttributeNS(e.paper.xlink,"href",j[1]),y[b](M);var C=m.createElement("img");C.style.cssText="position:absolute;left:-9999em;top-9999em",C.onload=function(){Lt(y,{width:this.offsetWidth,height:this.offsetHeight}),Lt(M,{width:this.offsetWidth,height:this.offsetHeight}),m.body.removeChild(this),e.paper.safari()},m.body[b](C),C.src=j[1],e.paper.defs[b](y),s.style.fill="url(#"+y.id+")",Lt(s,{fill:"url(#"+y.id+")"}),e.pattern=y,e.pattern&&Dt(e);break}var I=t.getRGB(f);if(I.error){if(({circle:1,ellipse:1}[d](e.type)||"r"!=S(f).charAt())&&Rt(s,f,e.paper)){o.gradient=f,o.fill="none";break}delete i.gradient,delete o.gradient,!t.is(o.opacity,"undefined")&&t.is(i.opacity,"undefined")&&Lt(s,{opacity:o.opacity}),!t.is(o["fill-opacity"],"undefined")&&t.is(i["fill-opacity"],"undefined")&&Lt(s,{"fill-opacity":o["fill-opacity"]})}I[d]("opacity")&&Lt(s,{"fill-opacity":I.opacity>1?I.opacity/100:I.opacity});case"stroke":I=t.getRGB(f),s[$](l,I.hex),"stroke"==l&&I[d]("opacity")&&Lt(s,{"stroke-opacity":I.opacity>1?I.opacity/100:I.opacity});break;case"gradient":(({circle:1,ellipse:1})[d](e.type)||"r"!=S(f).charAt())&&Rt(s,f,e.paper);break;case"opacity":o.gradient&&!o[d]("stroke-opacity")&&Lt(s,{"stroke-opacity":f>1?f/100:f});case"fill-opacity":if(o.gradient){var _=m.getElementById(s.getAttribute(Y)[rt](/^url\(#|\)$/g,T));if(_){var O=_.getElementsByTagName("stop");O[O[N]-1][$]("stop-opacity",f)}break}default:"font-size"==l&&(f=K(f,10)+"px");var B=l[rt](/(\-.)/g,function(t){return tt.call(t.substring(1))});s.style[B]=f,s[$](l,f)}}Vt(e,i),u?e.rotate(u.join(E)):Q(a)&&e.rotate(a,!0)},Yt=1.2,Vt=function(e,i){if("text"==e.type&&(i[d]("text")||i[d]("font")||i[d]("font-size")||i[d]("x")||i[d]("y"))){var r=e.attrs,n=e.node,s=n.firstChild?K(m.defaultView.getComputedStyle(n.firstChild,T).getPropertyValue("font-size"),10):10;if(i[d]("text")){for(r.text=i.text;n.firstChild;)n.removeChild(n.firstChild);for(var o=S(i.text)[q]("\n"),a=0,c=o[N];c>a;a++)if(o[a]){var u=Lt("tspan");a&&Lt(u,{dy:s*Yt,x:r.x}),u[b](m.createTextNode(o[a])),n[b](u)}}else for(o=n.getElementsByTagName("tspan"),a=0,c=o[N];c>a;a++)a&&Lt(o[a],{dy:s*Yt,x:r.x});Lt(n,{y:r.y});var h=e.getBBox(),l=r.y-(h.y+h.height/2);l&&t.is(l,"finite")&&Lt(n,{y:r.y+l})}},zt=function(e,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Gt=zt[p];zt[p].rotate=function(e,i,r){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](E):this._.rt.deg;var n=this.getBBox();return e=S(e)[q](h),e[N]-1&&(i=Q(e[1]),r=Q(e[2])),e=Q(e[0]),null!=i&&i!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==r&&(i=null),this._.rt.cx=i,this._.rt.cy=r,i=null==i?n.x+n.width/2:i,r=null==r?n.y+n.height/2:r,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,r),this.clip&&Lt(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,r)})):(this.transformations[0]=T,this.clip&&Lt(this.clip,{transform:T})),Lt(this.node,{transform:this.transformations[A](E)}),this},zt[p].hide=function(){return!this.removed&&(this.node.style.display="none"),this},zt[p].show=function(){return!this.removed&&(this.node.style.display=""),this},zt[p].remove=function(){if(!this.removed){Ut(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},zt[p].getBBox=function(){if(this.removed)return this;if("path"==this.type)return yt(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var i=0,r=this.node.getNumberOfChars();r>i;i++){var n=this.node.getExtentOfChar(i);n.y<e.y&&(e.y=n.y),n.y+n.height-e.y>e.height&&(e.height=n.y+n.height-e.y),n.x+n.width-e.x>e.width&&(e.width=n.x+n.width-e.x)}}return t&&this.hide(),e},zt[p].attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[d](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,R))return"translation"==e?Me.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==Y&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==i&&t.is(e,D)){for(var s={},o=0,a=e.length;a>o;o++)s[e[o]]=this.attr(e[o]);return s}if(null!=i){var c={};c[e]=i}else null!=e&&t.is(e,"object")&&(c=e);for(var u in this.paper.customAttributes)if(this.paper.customAttributes[d](u)&&c[d](u)&&t.is(this.paper.customAttributes[u],"function")){var h=this.paper.customAttributes[u].apply(this,[][w](c[u]));this.attrs[u]=c[u];for(var l in h)h[d](l)&&(c[l]=h[l])}return Xt(this,c),this},zt[p].toFront=function(){if(this.removed)return this;this.node.parentNode[b](this.node);var t=this.paper;return t.top!=this&&Ct(this,t),this},zt[p].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),It(this,this.paper);this.paper}return this},zt[p].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[b](this.node),_t(this,t,this.paper),this},zt[p].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),Ot(this,t,this.paper),this},zt[p].blur=function(t){var e=this;if(0!==+t){var i=Lt("filter"),n=Lt("feGaussianBlur");e.attrs.blur=t,i.id=r(),Lt(n,{stdDeviation:+t||1.5}),i.appendChild(n),e.paper.defs.appendChild(i),e._blur=i,Lt(e.node,{filter:"url(#"+i.id+")"})}else e._blur&&(e._blur.parentNode.removeChild(e._blur),delete e._blur,delete e.attrs.blur),e.node.removeAttribute("filter")};var Ht=function(t,e,i,r){var n=Lt("circle");t.canvas&&t.canvas[b](n);var s=new zt(n,t);return s.attrs={cx:e,cy:i,r:r,fill:"none",stroke:"#000"},s.type="circle",Lt(n,s.attrs),s},Ft=function(t,e,i,r,n,s){var o=Lt("rect");t.canvas&&t.canvas[b](o);var a=new zt(o,t);return a.attrs={x:e,y:i,width:r,height:n,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},a.type="rect",Lt(o,a.attrs),a},Wt=function(t,e,i,r,n){var s=Lt("ellipse");t.canvas&&t.canvas[b](s);var o=new zt(s,t);return o.attrs={cx:e,cy:i,rx:r,ry:n,fill:"none",stroke:"#000"},o.type="ellipse",Lt(s,o.attrs),o},Zt=function(t,e,i,r,n,s){var o=Lt("image");Lt(o,{x:i,y:r,width:n,height:s,preserveAspectRatio:"none"}),o.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[b](o);var a=new zt(o,t);return a.attrs={x:i,y:r,width:n,height:s,src:e},a.type="image",a},$t=function(t,e,i,r){var n=Lt("text");Lt(n,{x:e,y:i,"text-anchor":"middle"}),t.canvas&&t.canvas[b](n);var s=new zt(n,t);return s.attrs={x:e,y:i,"text-anchor":"middle",text:r,font:et.font,stroke:"none",fill:"#000"},s.type="text",Xt(s,s.attrs),s},Qt=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas[$]("width",this.width),this.canvas[$]("height",this.height),this},Kt=function(){var e=At[x](0,arguments),i=e&&e.container,r=e.x,n=e.y,s=e.width,o=e.height;if(!i)throw new Error("SVG container not found.");var a=Lt("svg");return r=r||0,n=n||0,s=s||512,o=o||342,Lt(a,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:s,height:o}),1==i?(a.style.cssText="position:absolute;left:"+r+"px;top:"+n+"px",m.body[b](a)):i.firstChild?i.insertBefore(a,i.firstChild):i[b](a),i=new y,i.width=s,i.height=o,i.canvas=a,Nt.call(i,i,t.fn),i.clear(),i};u.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=Lt("desc"))[b](m.createTextNode("Created with Rapha\xebl")),t[b](this.desc),t[b](this.defs=Lt("defs"))},u.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Bt(t)}}if(t.vml){var Jt={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},te=/([clmz]),?([^clmz]*)/gi,ee=/ progid:\S+Blur\([^\)]+\)/g,ie=/-?[^,\s-]+/g,re=1e3+E+1e3,ne=10,se={path:1,rect:1},oe=function(t){var e=/[ahqstv]/gi,i=wt;if(S(t).match(e)&&(i=jt),e=/[clmz]/g,i==wt&&!S(t).match(e)){var r=S(t)[rt](te,function(t,e,i){var r=[],n="m"==U.call(e),s=Jt[e];return i[rt](ie,function(t){n&&2==r[N]&&(s+=r+Jt["m"==e?"l":"L"],r=[]),r[z](Z(t*ne))}),s+r});return r}var n,s,o=i(t);r=[];for(var a=0,c=o[N];c>a;a++){n=o[a],s=U.call(o[a][0]),"z"==s&&(s="x");for(var u=1,h=n[N];h>u;u++)s+=Z(n[u]*ne)+(u!=h-1?",":T);r[z](s)}return r[A](E)};t[X]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\xebl "+this.version},Pt=function(t,e){var i=ae("group");i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=e.coordsize,i.coordorigin=e.coordorigin;var r=ae("shape"),n=r.style;n.width=e.width+"px",n.height=e.height+"px",r.coordsize=re,r.coordorigin=e.coordorigin,i[b](r);var s=new zt(r,i,e),o={fill:"none",stroke:"#000"};return t&&(o.path=t),s.type="path",s.path=[],s.Path=T,Xt(s,o),e.canvas[b](i),s},Xt=function(e,i){e.attrs=e.attrs||{};var r,n=e.node,o=e.attrs,a=n.style,c=(i.x!=o.x||i.y!=o.y||i.width!=o.width||i.height!=o.height||i.r!=o.r)&&"rect"==e.type,u=e;for(var l in i)i[d](l)&&(o[l]=i[l]);if(c&&(o.path=s(o.x,o.y,o.width,o.height,o.r),e.X=o.x,e.Y=o.y,e.W=o.width,e.H=o.height),i.href&&(n.href=i.href),i.title&&(n.title=i.title),i.target&&(n.target=i.target),i.cursor&&(a.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||c)&&(n.path=oe(o.path)),null!=i.rotation&&e.rotate(i.rotation,!0),i.translation&&(r=S(i.translation)[q](h),Me.call(e,r[0],r[1]),null!=e._.rt.cx&&(e._.rt.cx+=+r[0],e._.rt.cy+=+r[1],e.setBox(e.attrs,r[0],r[1]))),i.scale&&(r=S(i.scale)[q](h),e.scale(+r[0]||1,+r[1]||+r[0]||1,+r[2]||null,+r[3]||null)),"clip-rect"in i){var f=S(i["clip-rect"])[q](h);if(4==f[N]){f[2]=+f[2]+ +f[0],f[3]=+f[3]+ +f[1];var p=n.clipRect||m.createElement("div"),g=p.style,v=n.parentNode;g.clip=t.format("rect({1}px {2}px {3}px {0}px)",f),n.clipRect||(g.position="absolute",g.top=0,g.left=0,g.width=e.paper.width+"px",g.height=e.paper.height+"px",v.parentNode.insertBefore(p,v),p[b](v),n.clipRect=p)}i["clip-rect"]||n.clipRect&&(n.clipRect.style.clip=T)}if("image"==e.type&&i.src&&(n.src=i.src),"image"==e.type&&i.opacity&&(n.filterOpacity=J+".Alpha(opacity="+100*i.opacity+")",a.filter=(n.filterMatrix||T)+(n.filterOpacity||T)),i.font&&(a.font=i.font),i["font-family"]&&(a.fontFamily='"'+i["font-family"][q](",")[0][rt](/^['"]+|['"]+$/g,T)+'"'),i["font-size"]&&(a.fontSize=i["font-size"]),i["font-weight"]&&(a.fontWeight=i["font-weight"]),i["font-style"]&&(a.fontStyle=i["font-style"]),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){n=e.shape||n;var y=n.getElementsByTagName(Y)&&n.getElementsByTagName(Y)[0],x=!1;if(!y&&(x=y=ae(Y)),"fill-opacity"in i||"opacity"in i){var w=((+o["fill-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+t.getRGB(i.fill).o+1||2)-1);w=_(I(w,0),1),y.opacity=w}if(i.fill&&(y.on=!0),(null==y.on||"none"==i.fill)&&(y.on=!1),y.on&&i.fill){var k=i.fill.match(G);k?(y.src=k[1],y.type="tile"):(y.color=t.getRGB(i.fill).hex,y.src=T,y.type="solid",t.getRGB(i.fill).error&&(u.type in{circle:1,ellipse:1}||"r"!=S(i.fill).charAt())&&Rt(u,i.fill)&&(o.fill="none",o.gradient=i.fill))}x&&n[b](y);var E=n.getElementsByTagName("stroke")&&n.getElementsByTagName("stroke")[0],j=!1;!E&&(j=E=ae("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(E.on=!0),("none"==i.stroke||null==E.on||0==i.stroke||0==i["stroke-width"])&&(E.on=!1);var M=t.getRGB(i.stroke);E.on&&i.stroke&&(E.color=M.hex),w=((+o["stroke-opacity"]+1||2)-1)*((+o.opacity+1||2)-1)*((+M.o+1||2)-1);var A=.75*(Q(i["stroke-width"])||1);if(w=_(I(w,0),1),null==i["stroke-width"]&&(A=o["stroke-width"]),i["stroke-width"]&&(E.weight=A),A&&1>A&&(w*=A)&&(E.weight=1),E.opacity=w,i["stroke-linejoin"]&&(E.joinstyle=i["stroke-linejoin"]||"miter"),E.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(E.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var U={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};E.dashstyle=U[d](i["stroke-dasharray"])?U[i["stroke-dasharray"]]:T}j&&n[b](E)}if("text"==u.type)switch(a=u.paper.span.style,o.font&&(a.font=o.font),o["font-family"]&&(a.fontFamily=o["font-family"]),o["font-size"]&&(a.fontSize=o["font-size"]),o["font-weight"]&&(a.fontWeight=o["font-weight"]),o["font-style"]&&(a.fontStyle=o["font-style"]),u.node.string&&(u.paper.span.innerHTML=S(u.node.string)[rt](/</g,"&#60;")[rt](/&/g,"&#38;")[rt](/\n/g,"<br>")),
u.W=o.w=u.paper.span.offsetWidth,u.H=o.h=u.paper.span.offsetHeight,u.X=o.x,u.Y=o.y+Z(u.H/2),o["text-anchor"]){case"start":u.node.style["v-text-align"]="left",u.bbx=Z(u.W/2);break;case"end":u.node.style["v-text-align"]="right",u.bbx=-Z(u.W/2);break;default:u.node.style["v-text-align"]="center"}},Rt=function(t,e){t.attrs=t.attrs||{};var i,r=(t.attrs,"linear"),n=".5 .5";if(t.attrs.gradient=e,e=S(e)[rt](ht,function(t,e,i){return r="radial",e&&i&&(e=Q(e),i=Q(i),B(e-.5,2)+B(i-.5,2)>.25&&(i=C.sqrt(.25-B(e-.5,2))*(2*(i>.5)-1)+.5),n=e+E+i),T}),e=e[q](/\s*\-\s*/),"linear"==r){var s=e.shift();if(s=-Q(s),isNaN(s))return null}var o=Mt(e);if(!o)return null;if(t=t.shape||t.node,i=t.getElementsByTagName(Y)[0]||ae(Y),!i.parentNode&&t.appendChild(i),o[N]){i.on=!0,i.method="none",i.color=o[0].color,i.color2=o[o[N]-1].color;for(var a=[],c=0,u=o[N];u>c;c++)o[c].offset&&a[z](o[c].offset+E+o[c].color);i.colors&&(i.colors.value=a[N]?a[A]():"0% "+i.color),"radial"==r?(i.type="gradientradial",i.focus="100%",i.focussize=n,i.focusposition=n):(i.type="gradient",i.angle=(270-s)%360)}return 1},zt=function(e,i,r){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=i,this.paper=r,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},Gt=zt[p],Gt.rotate=function(t,e,i){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][A](E):this._.rt.deg:(t=S(t)[q](h),t[N]-1&&(e=Q(t[1]),i=Q(t[2])),t=Q(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==i&&(e=null),this._.rt.cx=e,this._.rt.cy=i,this.setBox(this.attrs,e,i),this.Group.style.rotation=this._.rt.deg,this)},Gt.setBox=function(t,e,i){if(this.removed)return this;var r=this.Group.style,n=this.shape&&this.shape.style||this.node.style;t=t||{};for(var s in t)t[d](s)&&(this.attrs[s]=t[s]);e=e||this._.rt.cx,i=i||this._.rt.cy;var o,a,c,u,h=this.attrs;switch(this.type){case"circle":o=h.cx-h.r,a=h.cy-h.r,c=u=2*h.r;break;case"ellipse":o=h.cx-h.rx,a=h.cy-h.ry,c=2*h.rx,u=2*h.ry;break;case"image":o=+h.x,a=+h.y,c=h.width||0,u=h.height||0;break;case"text":this.textpath.v=["m",Z(h.x),", ",Z(h.y-2),"l",Z(h.x)+1,", ",Z(h.y-2)][A](T),o=h.x-Z(this.W/2),a=h.y-this.H/2,c=this.W,u=this.H;break;case"rect":case"path":if(this.attrs.path){var l=yt(this.attrs.path);o=l.x,a=l.y,c=l.width,u=l.height}else o=0,a=0,c=this.paper.width,u=this.paper.height;break;default:o=0,a=0,c=this.paper.width,u=this.paper.height}e=null==e?o+c/2:e,i=null==i?a+u/2:i;var f,p=e-this.paper.width/2,m=i-this.paper.height/2;r.left!=(f=p+"px")&&(r.left=f),r.top!=(f=m+"px")&&(r.top=f),this.X=se[d](this.type)?-p:o,this.Y=se[d](this.type)?-m:a,this.W=c,this.H=u,se[d](this.type)?(n.left!=(f=-p*ne+"px")&&(n.left=f),n.top!=(f=-m*ne+"px")&&(n.top=f)):"text"==this.type?(n.left!=(f=-p+"px")&&(n.left=f),n.top!=(f=-m+"px")&&(n.top=f)):(r.width!=(f=this.paper.width+"px")&&(r.width=f),r.height!=(f=this.paper.height+"px")&&(r.height=f),n.left!=(f=o-p+"px")&&(n.left=f),n.top!=(f=a-m+"px")&&(n.top=f),n.width!=(f=c+"px")&&(n.width=f),n.height!=(f=u+"px")&&(n.height=f))},Gt.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Gt.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Gt.getBBox=function(){return this.removed?this:se[d](this.type)?yt(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Gt.remove=function(){if(!this.removed){Ut(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},Gt.attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[d](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,"string"))return"translation"==e?Me.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==Y&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==i&&t.is(e,D)){var s,o={};for(n=0,s=e[N];s>n;n++)o[e[n]]=this.attr(e[n]);return o}var a;if(null!=i&&(a={},a[e]=i),null==i&&t.is(e,"object")&&(a=e),a){for(var c in this.paper.customAttributes)if(this.paper.customAttributes[d](c)&&a[d](c)&&t.is(this.paper.customAttributes[c],"function")){var u=this.paper.customAttributes[c].apply(this,[][w](a[c]));this.attrs[c]=a[c];for(var h in u)u[d](h)&&(a[h]=u[h])}a.text&&"text"==this.type&&(this.node.string=a.text),Xt(this,a),a.gradient&&({circle:1,ellipse:1}[d](this.type)||"r"!=S(a.gradient).charAt())&&Rt(this,a.gradient),(!se[d](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Gt.toFront=function(){return!this.removed&&this.Group.parentNode[b](this.Group),this.paper.top!=this&&Ct(this,this.paper),this},Gt.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),It(this,this.paper)),this)},Gt.insertAfter=function(t){return this.removed?this:(t.constructor==Ae&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[b](this.Group),_t(this,t,this.paper),this)},Gt.insertBefore=function(t){return this.removed?this:(t.constructor==Ae&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),Ot(this,t,this.paper),this)},Gt.blur=function(e){var i=this.node.runtimeStyle,r=i.filter;r=r.replace(ee,T),0!==+e?(this.attrs.blur=e,i.filter=r+E+J+".Blur(pixelradius="+(+e||1.5)+")",i.margin=t.format("-{0}px 0 0 -{0}px",Z(+e||1.5))):(i.filter=r,i.margin=0,delete this.attrs.blur)},Ht=function(t,e,i,r){var n=ae("group"),s=ae("oval");s.style;n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=re,n.coordorigin=t.coordorigin,n[b](s);var o=new zt(s,n,t);return o.type="circle",Xt(o,{stroke:"#000",fill:"none"}),o.attrs.cx=e,o.attrs.cy=i,o.attrs.r=r,o.setBox({x:e-r,y:i-r,width:2*r,height:2*r}),t.canvas[b](n),o},Ft=function(t,e,i,r,n,o){var a=s(e,i,r,n,o),c=t.path(a),u=c.attrs;return c.X=u.x=e,c.Y=u.y=i,c.W=u.width=r,c.H=u.height=n,u.r=o,u.path=a,c.type="rect",c},Wt=function(t,e,i,r,n){var s=ae("group"),o=ae("oval");o.style;s.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",s.coordsize=re,s.coordorigin=t.coordorigin,s[b](o);var a=new zt(o,s,t);return a.type="ellipse",Xt(a,{stroke:"#000"}),a.attrs.cx=e,a.attrs.cy=i,a.attrs.rx=r,a.attrs.ry=n,a.setBox({x:e-r,y:i-n,width:2*r,height:2*n}),t.canvas[b](s),a},Zt=function(t,e,i,r,n,s){var o=ae("group"),a=ae("image");o.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",o.coordsize=re,o.coordorigin=t.coordorigin,a.src=e,o[b](a);var c=new zt(a,o,t);return c.type="image",c.attrs.src=e,c.attrs.x=i,c.attrs.y=r,c.attrs.w=n,c.attrs.h=s,c.setBox({x:i,y:r,width:n,height:s}),t.canvas[b](o),c},$t=function(e,i,r,n){var s=ae("group"),o=ae("shape"),a=o.style,c=ae("path"),u=(c.style,ae("textpath"));s.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",s.coordsize=re,s.coordorigin=e.coordorigin,c.v=t.format("m{0},{1}l{2},{1}",Z(10*i),Z(10*r),Z(10*i)+1),c.textpathok=!0,a.width=e.width,a.height=e.height,u.string=S(n),u.on=!0,o[b](u),o[b](c),s[b](o);var h=new zt(u,s,e);return h.shape=o,h.textpath=c,h.type="text",h.attrs.text=n,h.attrs.x=i,h.attrs.y=r,h.attrs.w=1,h.attrs.h=1,Xt(h,{font:et.font,stroke:"none",fill:"#000"}),h.setBox(),e.canvas[b](s),h},Qt=function(t,e){var i=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),i.width=t,i.height=e,i.clip="rect(0 "+t+" "+e+" 0)",this};var ae;m.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!m.namespaces.rvml&&m.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),ae=function(t){return m.createElement("<rvml:"+t+' class="rvml">')}}catch(t){ae=function(t){return m.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Kt=function(){var e=At[x](0,arguments),i=e.container,r=e.height,n=e.width,s=e.x,o=e.y;if(!i)throw new Error("VML container not found.");var a=new y,c=a.canvas=m.createElement("div"),u=c.style;return s=s||0,o=o||0,n=n||512,r=r||342,n==+n&&(n+="px"),r==+r&&(r+="px"),a.width=1e3,a.height=1e3,a.coordsize=1e3*ne+E+1e3*ne,a.coordorigin="0 0",a.span=m.createElement("span"),a.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",c[b](a.span),u.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,r),1==i?(m.body[b](c),u.left=s+"px",u.top=o+"px",u.position="absolute"):i.firstChild?i.insertBefore(c,i.firstChild):i[b](c),Nt.call(a,a,t.fn),a},u.clear=function(){this.canvas.innerHTML=T,this.span=m.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[b](this.span),this.bottom=this.top=null},u.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Bt(t);return!0}}var ce=navigator.userAgent.match(/Version\\x2f(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(ce&&ce[1]<4||"iP"==navigator.platform.slice(0,2))?u.safari=function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});g.setTimeout(function(){t.remove()})}:u.safari=function(){};for(var ue=function(){this.returnValue=!1},he=function(){return this.originalEvent.preventDefault()},le=function(){this.cancelBubble=!0},fe=function(){return this.originalEvent.stopPropagation()},pe=function(){return m.addEventListener?function(t,e,i,r){var n=k&&M[e]?M[e]:e,s=function(n){if(k&&M[d](e))for(var s=0,o=n.targetTouches&&n.targetTouches.length;o>s;s++)if(n.targetTouches[s].target==t){var a=n;n=n.targetTouches[s],n.originalEvent=a,n.preventDefault=he,n.stopPropagation=fe;break}return i.call(r,n)};return t.addEventListener(n,s,!1),function(){return t.removeEventListener(n,s,!1),!0}}:m.attachEvent?function(t,e,i,r){var n=function(t){return t=t||g.event,t.preventDefault=t.preventDefault||ue,t.stopPropagation=t.stopPropagation||le,i.call(r,t)};t.attachEvent("on"+e,n);var s=function(){return t.detachEvent("on"+e,n),!0};return s}:void 0}(),de=[],me=function(t){for(var e,i=t.clientX,r=t.clientY,n=m.documentElement.scrollTop||m.body.scrollTop,s=m.documentElement.scrollLeft||m.body.scrollLeft,o=de.length;o--;){if(e=de[o],k){for(var a,c=t.touches.length;c--;)if(a=t.touches[c],a.identifier==e.el._drag.id){i=a.clientX,r=a.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();i+=s,r+=n,e.move&&e.move.call(e.move_scope||e.el,i-e.el._drag.x,r-e.el._drag.y,i,r,t)}},ge=function(e){t.unmousemove(me).unmouseup(ge);for(var i,r=de.length;r--;)i=de[r],i.el._drag={},i.end&&i.end.call(i.end_scope||i.start_scope||i.move_scope||i.el,e);de=[]},ve=j[N];ve--;)(function(e){t[e]=zt[p][e]=function(i,r){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:e,f:i,unbind:pe(this.shape||this.node||m,e,i,r||this)})),this},t["un"+e]=zt[p]["un"+e]=function(t){for(var i=this.events,r=i[N];r--;)if(i[r].name==e&&i[r].f==t)return i[r].unbind(),i.splice(r,1),!i.length&&delete this.events,this;return this}})(j[ve]);Gt.hover=function(t,e,i,r){return this.mouseover(t,i).mouseout(e,r||i)},Gt.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},Gt.drag=function(e,i,r,n,s,o){return this._drag={},this.mousedown(function(a){(a.originalEvent||a).preventDefault();var c=m.documentElement.scrollTop||m.body.scrollTop,u=m.documentElement.scrollLeft||m.body.scrollLeft;this._drag.x=a.clientX+u,this._drag.y=a.clientY+c,this._drag.id=a.identifier,i&&i.call(s||n||this,a.clientX+u,a.clientY+c,a),!de.length&&t.mousemove(me).mouseup(ge),de.push({el:this,move:e,end:r,move_scope:n,start_scope:s,end_scope:o})}),this},Gt.undrag=function(e,i,r){for(var n=de.length;n--;)de[n].el==this&&de[n].move==e&&de[n].end==r&&de.splice(n++,1);!de.length&&t.unmousemove(me).unmouseup(ge)},u.circle=function(t,e,i){return Ht(this,t||0,e||0,i||0)},u.rect=function(t,e,i,r,n){return Ft(this,t||0,e||0,i||0,r||0,n||0)},u.ellipse=function(t,e,i,r){return Wt(this,t||0,e||0,i||0,r||0)},u.path=function(e){return e&&!t.is(e,R)&&!t.is(e[0],D)&&(e+=T),Pt(t.format[x](t,arguments),this)},u.image=function(t,e,i,r,n){return Zt(this,t||"about:blank",e||0,i||0,r||0,n||0)},u.text=function(t,e,i){return $t(this,t||0,e||0,S(i))},u.set=function(t){return arguments[N]>1&&(t=Array[p].splice.call(arguments,0,arguments[N])),new Ae(t)},u.setSize=Qt,u.top=u.bottom=null,u.raphael=t,Gt.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,void(this.attrs.scale="1 1"))},Gt.scale=function(t,e,i,r){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:o};e=e||t,!+e&&(e=t);var n,s,a=this.attrs;if(0!=t){var c=this.getBBox(),u=c.x+c.width/2,h=c.y+c.height/2,l=O(t/this._.sx),f=O(e/this._.sy);i=+i||0==i?i:u,r=+r||0==r?r:h;var p=this._.sx>0,d=this._.sy>0,m=~~(t/O(t)),g=~~(e/O(e)),v=l*m,y=f*g,b=this.node.style,x=i+O(u-i)*v*(u>i==p?1:-1),k=r+O(h-r)*y*(h>r==d?1:-1),S=t*m>e*g?f:l;switch(this.type){case"rect":case"image":var q=a.width*l,j=a.height*f;this.attr({height:j,r:a.r*S,width:q,x:x-q/2,y:k-j/2});break;case"circle":case"ellipse":this.attr({rx:a.rx*l,ry:a.ry*f,r:a.r*S,cx:x,cy:k});break;case"text":this.attr({x:x,y:k});break;case"path":for(var M=xt(a.path),U=!0,C=p?v:l,I=d?y:f,_=0,B=M[N];B>_;_++){var L=M[_],P=tt.call(L[0]);if("M"!=P||!U)if(U=!1,"A"==P)L[M[_][N]-2]*=C,L[M[_][N]-1]*=I,L[1]*=l,L[2]*=f,L[5]=+(m+g?!!+L[5]:!+L[5]);else if("H"==P)for(var R=1,D=L[N];D>R;R++)L[R]*=C;else if("V"==P)for(R=1,D=L[N];D>R;R++)L[R]*=I;else for(R=1,D=L[N];D>R;R++)L[R]*=R%2?C:I}var X=yt(M);n=x-X.x-X.width/2,s=k-X.y-X.height/2,M[0][1]+=n,M[0][2]+=s,this.attr({path:M})}this.type in{text:1,image:1}&&(1!=m||1!=g)?this.transformations?(this.transformations[2]="scale("[w](m,",",g,")"),this.node[$]("transform",this.transformations[A](E)),n=-1==m?-a.x-(q||0):a.x,s=-1==g?-a.y-(j||0):a.y,this.attr({x:n,y:s}),a.fx=m-1,a.fy=g-1):(this.node.filterMatrix=J+".Matrix(M11="[w](m,", M12=0, M21=0, M22=",g,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),b.filter=(this.node.filterMatrix||T)+(this.node.filterOpacity||T)):this.transformations?(this.transformations[2]=T,this.node[$]("transform",this.transformations[A](E)),a.fx=0,a.fy=0):(this.node.filterMatrix=T,b.filter=(this.node.filterMatrix||T)+(this.node.filterOpacity||T)),a.scale=[t,e,i,r][A](E),this._.sx=t,this._.sy=e}return this},Gt.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var ye={},be=function(e,i,r,n,s,o,a,c,u){var h,l,f=0,p=100,d=[e,i,r,n,s,o,a,c].join(),m=ye[d];if(!m&&(ye[d]=m={data:[]}),m.timer&&clearTimeout(m.timer),m.timer=setTimeout(function(){delete ye[d]},2e3),null!=u){var g=be(e,i,r,n,s,o,a,c);p=10*~~g}for(var v=0;p+1>v;v++){if(m.data[u]>v?l=m.data[v*p]:(l=t.findDotsAtSegment(e,i,r,n,s,o,a,c,v/p),m.data[v]=l),v&&(f+=B(B(h.x-l.x,2)+B(h.y-l.y,2),.5)),null!=u&&f>=u)return l;h=l}return null==u?f:void 0},xe=function(e,i){return function(r,n,s){r=jt(r);for(var o,a,c,u,h,l="",f={},p=0,d=0,m=r.length;m>d;d++){if(c=r[d],"M"==c[0])o=+c[1],a=+c[2];else{if(u=be(o,a,c[1],c[2],c[3],c[4],c[5],c[6]),p+u>n){if(i&&!f.start){if(h=be(o,a,c[1],c[2],c[3],c[4],c[5],c[6],n-p),l+=["C",h.start.x,h.start.y,h.m.x,h.m.y,h.x,h.y],s)return l;f.start=l,l=["M",h.x,h.y+"C",h.n.x,h.n.y,h.end.x,h.end.y,c[5],c[6]][A](),p+=u,o=+c[5],a=+c[6];continue}if(!e&&!i)return h=be(o,a,c[1],c[2],c[3],c[4],c[5],c[6],n-p),{x:h.x,y:h.y,alpha:h.alpha}}p+=u,o=+c[5],a=+c[6]}l+=c}return f.end=l,h=e?p:i?f:t.findDotsAtSegment(o,a,c[1],c[2],c[3],c[4],c[5],c[6],1),h.alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},we=xe(1),ke=xe(),Te=xe(0,1);Gt.getTotalLength=function(){return"path"==this.type?this.node.getTotalLength?this.node.getTotalLength():we(this.attrs.path):void 0},Gt.getPointAtLength=function(t){return"path"==this.type?ke(this.attrs.path,t):void 0},Gt.getSubpath=function(t,e){if("path"==this.type){if(O(this.getTotalLength()-e)<"1e-6")return Te(this.attrs.path,t).end;var i=Te(this.attrs.path,e,1);return t?Te(i,t).end:i}},t.easing_formulas={linear:function(t){return t},"<":function(t){return B(t,3)},">":function(t){return B(t-1,3)+1},"<>":function(t){return t=2*t,1>t?B(t,3)/2:(t-=2,(B(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,i=e/4;return B(2,-10*t)*C.sin((t-i)*(2*L)/e)+1},bounce:function(t){var e,i=7.5625,r=2.75;return 1/r>t?e=i*t*t:2/r>t?(t-=1.5/r,e=i*t*t+.75):2.5/r>t?(t-=2.25/r,e=i*t*t+.9375):(t-=2.625/r,e=i*t*t+.984375),e}};var Ee=[],Se=function(){for(var e=+new Date,i=0;i<Ee[N];i++){var r=Ee[i];if(!r.stop&&!r.el.removed){var n,s=e-r.start,o=r.ms,a=r.easing,c=r.from,u=r.diff,h=r.to,l=r.t,f=r.el,p={};if(o>s){var m=a(s/o);for(var g in c)if(c[d](g)){switch(it[g]){case"along":n=m*o*u[g],h.back&&(n=h.len-n);var v=ke(h[g],n);f.translate(u.sx-u.x||0,u.sy-u.y||0),u.x=v.x,u.y=v.y,f.translate(v.x-u.sx,v.y-u.sy),h.rot&&f.rotate(u.r+v.alpha,v.x,v.y);break;case P:n=+c[g]+m*o*u[g];break;case"colour":n="rgb("+[je(Z(c[g].r+m*o*u[g].r)),je(Z(c[g].g+m*o*u[g].g)),je(Z(c[g].b+m*o*u[g].b))][A](",")+")";break;case"path":n=[];for(var y=0,b=c[g][N];b>y;y++){n[y]=[c[g][y][0]];for(var x=1,w=c[g][y][N];w>x;x++)n[y][x]=+c[g][y][x]+m*o*u[g][y][x];n[y]=n[y][A](E)}n=n[A](E);break;case"csv":switch(g){case"translation":var k=m*o*u[g][0]-l.x,S=m*o*u[g][1]-l.y;l.x+=k,l.y+=S,n=k+E+S;break;case"rotation":n=+c[g][0]+m*o*u[g][0],c[g][1]&&(n+=","+c[g][1]+","+c[g][2]);break;case"scale":n=[+c[g][0]+m*o*u[g][0],+c[g][1]+m*o*u[g][1],2 in h[g]?h[g][2]:T,3 in h[g]?h[g][3]:T][A](E);break;case"clip-rect":for(n=[],y=4;y--;)n[y]=+c[g][y]+m*o*u[g][y]}break;default:var q=[].concat(c[g]);for(n=[],y=f.paper.customAttributes[g].length;y--;)n[y]=+q[y]+m*o*u[g][y]}p[g]=n}f.attr(p),f._run&&f._run.call(f)}else h.along&&(v=ke(h.along,h.len*!h.back),f.translate(u.sx-(u.x||0)+v.x-u.sx,u.sy-(u.y||0)+v.y-u.sy),h.rot&&f.rotate(u.r+v.alpha,v.x,v.y)),(l.x||l.y)&&f.translate(-l.x,-l.y),h.scale&&(h.scale+=T),f.attr(h),Ee.splice(i--,1)}}t.svg&&f&&f.paper&&f.paper.safari(),Ee[N]&&setTimeout(Se)},qe=function(e,i,r,n,s){var o=r-n;i.timeouts.push(setTimeout(function(){t.is(s,"function")&&s.call(i),i.animate(e,o,e.easing)},n))},je=function(t){return I(_(t,255),0)},Me=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:o};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var i=xt(this.attrs.path);i[0][1]+=+t,i[0][2]+=+e,this.attr({path:i})}return this};Gt.animateWith=function(t,e,i,r,n){for(var s=0,o=Ee.length;o>s;s++)Ee[s].el.id==t.id&&(e.start=Ee[s].start);return this.animate(e,i,r,n)},Gt.animateAlong=a(),Gt.animateAlongBack=a(1),Gt.onAnimation=function(t){return this._run=t||0,this},Gt.animate=function(e,i,r,n){var s=this;if(s.timeouts=s.timeouts||[],(t.is(r,"function")||!r)&&(n=r||null),s.removed)return n&&n.call(s),s;var o={},a={},u=!1,l={};for(var f in e)if(e[d](f)&&(it[d](f)||s.paper.customAttributes[d](f)))switch(u=!0,o[f]=s.attr(f),null==o[f]&&(o[f]=et[f]),a[f]=e[f],it[f]){case"along":var p=we(e[f]),m=ke(e[f],p*!!e.back),g=s.getBBox();l[f]=p/i,l.tx=g.x,l.ty=g.y,l.sx=m.x,l.sy=m.y,a.rot=e.rot,a.back=e.back,a.len=p,e.rot&&(l.r=Q(s.rotate())||0);break;case P:l[f]=(a[f]-o[f])/i;break;case"colour":o[f]=t.getRGB(o[f]);var v=t.getRGB(a[f]);l[f]={r:(v.r-o[f].r)/i,g:(v.g-o[f].g)/i,b:(v.b-o[f].b)/i};break;case"path":var y=jt(o[f],a[f]);o[f]=y[0];var b=y[1];l[f]=[];for(var x=0,w=o[f][N];w>x;x++){l[f][x]=[0];for(var k=1,T=o[f][x][N];T>k;k++)l[f][x][k]=(b[x][k]-o[f][x][k])/i}break;case"csv":var E=S(e[f])[q](h),j=S(o[f])[q](h);switch(f){case"translation":o[f]=[0,0],l[f]=[E[0]/i,E[1]/i];break;case"rotation":o[f]=j[1]==E[1]&&j[2]==E[2]?j:[0,E[1],E[2]],l[f]=[(E[0]-o[f][0])/i,0,0];break;case"scale":e[f]=E,o[f]=S(o[f])[q](h),l[f]=[(E[0]-o[f][0])/i,(E[1]-o[f][1])/i,0,0];break;case"clip-rect":for(o[f]=S(o[f])[q](h),l[f]=[],x=4;x--;)l[f][x]=(E[x]-o[f][x])/i}a[f]=E;break;default:for(E=[].concat(e[f]),j=[].concat(o[f]),l[f]=[],x=s.paper.customAttributes[f][N];x--;)l[f][x]=((E[x]||0)-(j[x]||0))/i}if(u){var M=t.easing_formulas[r];if(!M)if(M=S(r).match(W),M&&5==M[N]){var A=M;M=function(t){return c(t,+A[1],+A[2],+A[3],+A[4],i)}}else M=function(t){return t};Ee.push({start:e.start||+new Date,ms:i,easing:M,from:o,diff:l,to:a,el:s,t:{x:0,y:0}}),t.is(n,"function")&&(s._ac=setTimeout(function(){n.call(s)},i)),1==Ee[N]&&setTimeout(Se)}else{var U,C=[];for(var I in e)e[d](I)&&nt.test(I)&&(f={value:e[I]},"from"==I&&(I=0),"to"==I&&(I=100),f.key=K(I,10),C.push(f));for(C.sort(lt),C[0].key&&C.unshift({key:0,value:s.attrs}),x=0,w=C[N];w>x;x++)qe(C[x].value,s,i/100*C[x].key,i/100*(C[x-1]&&C[x-1].key||0),C[x-1]&&C[x-1].value.callback);U=C[C[N]-1].value.callback,U&&s.timeouts.push(setTimeout(function(){U.call(s)},i))}return this},Gt.stop=function(){for(var t=0;t<Ee.length;t++)Ee[t].el.id==this.id&&Ee.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;t<ii;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Gt.translate=function(t,e){return this.attr({translation:t+" "+e})},Gt[X]=function(){return"Rapha\xebl\u2019s object"},t.ae=Ee;var Ae=function(t){if(this.items=[],this[N]=0,this.type="set",t)for(var e=0,i=t[N];i>e;e++)!t[e]||t[e].constructor!=zt&&t[e].constructor!=Ae||(this[this.items[N]]=this.items[this.items[N]]=t[e],this[N]++)};Ae[p][z]=function(){for(var t,e,i=0,r=arguments[N];r>i;i++)t=arguments[i],!t||t.constructor!=zt&&t.constructor!=Ae||(e=this.items[N],this[e]=this.items[e]=t,this[N]++);return this},Ae[p].pop=function(){return delete this[this[N]--],this.items.pop()};for(var Ne in Gt)Gt[d](Ne)&&(Ae[p][Ne]=function(t){return function(){for(var e=0,i=this.items[N];i>e;e++)this.items[e][t][x](this.items[e],arguments);return this}}(Ne));Ae[p].attr=function(e,i){if(e&&t.is(e,D)&&t.is(e[0],"object"))for(var r=0,n=e[N];n>r;r++)this.items[r].attr(e[r]);else for(var s=0,o=this.items[N];o>s;s++)this.items[s].attr(e,i);return this},Ae[p].animate=function(e,i,r,n){(t.is(r,"function")||!r)&&(n=r||null);var s,o,a=this.items[N],c=a,u=this;for(n&&(o=function(){!--a&&n.call(u)}),r=t.is(r,R)?r:o,s=this.items[--c].animate(e,i,r,o);c--;)this.items[c]&&!this.items[c].removed&&this.items[c].animateWith(s,e,i,r,o);return this},Ae[p].insertAfter=function(t){for(var e=this.items[N];e--;)this.items[e].insertAfter(t);return this},Ae[p].getBBox=function(){for(var t=[],e=[],i=[],r=[],n=this.items[N];n--;){var s=this.items[n].getBBox();t[z](s.x),e[z](s.y),i[z](s.x+s.width),r[z](s.y+s.height)}return t=_[x](0,t),e=_[x](0,e),{x:t,y:e,width:I[x](0,i)-t,height:I[x](0,r)-e}},Ae[p].clone=function(t){t=new Ae;for(var e=0,i=this.items[N];i>e;e++)t[z](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var r in t.face)t.face[d](r)&&(e.face[r]=t.face[r]);if(this.fonts[i]?this.fonts[i][z](e):this.fonts[i]=[e],!t.svg){e.face["units-per-em"]=K(t.face["units-per-em"],10);for(var n in t.glyphs)if(t.glyphs[d](n)){var s=t.glyphs[n];if(e.glyphs[n]={w:s.w,k:{},d:s.d&&"M"+s.d[rt](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var o in s.k)s[d](o)&&(e.glyphs[n].k[o]=s.k[o])}}return t},u.getFont=function(e,i,r,n){if(n=n||"normal",r=r||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,t.fonts){var s=t.fonts[e];if(!s){var o=new RegExp("(^|\\s)"+e[rt](/[^\w\d\s+!~.:_-]/g,T)+"(\\s|$)","i");for(var a in t.fonts)if(t.fonts[d](a)&&o.test(a)){s=t.fonts[a];break}}var c;if(s)for(var u=0,h=s[N];h>u&&(c=s[u],c.face["font-weight"]!=i||c.face["font-style"]!=r&&c.face["font-style"]||c.face["font-stretch"]!=n);u++);return c}},u.print=function(e,i,r,n,s,o,a){o=o||"middle",a=I(_(a||0,1),-1);var c,u=this.set(),l=S(r)[q](T),f=0;if(t.is(n,r)&&(n=this.getFont(n)),n){c=(s||16)/n.face["units-per-em"];for(var p=n.face.bbox.split(h),d=+p[0],m=+p[1]+("baseline"==o?p[3]-p[1]+ +n.face.descent:(p[3]-p[1])/2),g=0,v=l[N];v>g;g++){var y=g&&n.glyphs[l[g-1]]||{},b=n.glyphs[l[g]];f+=g?(y.w||n.w)+(y.k&&y.k[l[g]]||0)+n.w*a:0,b&&b.d&&u[z](this.path(b.d).attr({fill:"#000",stroke:"none",translation:[f,0]}))}u.scale(c,c,d,m).translate(e-d,i-m)}return u},t.format=function(e,i){var r=t.is(i,D)?[0][w](i):arguments;return e&&t.is(e,R)&&r[N]-1&&(e=e[rt](f,function(t,e){return null==r[++e]?T:r[e]})),e||T},t.ninja=function(){return v.was?g.Raphael=v.is:delete e,t},t.el=Gt,t.st=Ae[p],v.was?g.Raphael=t:e=t}(),t=e}),define("scripts/lib/sound.js",function(t){function e(t){this.sound=new i.sound(t,{formats:["ogg","mp3"],preload:!0,autoload:!0,loop:!1})}var i=require("scripts/lib/buzz");return e.prototype.play=function(){this.sound.setPercent(0),this.sound.setVolume(100),this.sound.play()},e.prototype.stop=function(){this.sound.fadeOut(1e3,function(){this.pause()})},t.create=function(t){return new e(t)},t}),define("scripts/lib/tween.js",function(t){return t.exponential=function(){},t.exponential.co=function(t,e,i,r){return t==r?e+i:i*(-Math.pow(2,-10*t/r)+1)+e},t.bounce=function(){},t.bounce.co=function(t,e,i,r){return(t/=r)<1/2.75?i*(7.5625*t*t)+e:2/2.75>t?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:2.5/2.75>t?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e},t.quadratic=function(){},t.quadratic.ci=function(t,e,i,r){return i*(t/=r)*t+e},t.quadratic.co=function(t,e,i,r){return-i*(t/=r)*(t-2)+e},t.quadratic.cio=function(t,e,i,r){return(t/=r/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},t.circular=function(t,e,i,r){return(t/=r/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e},t.linear=function(t,e,i,r){return i*t/r+e},t.back=function(){},t.back.ci=function(t,e,i,r,n){return n=1.70158,i*(t/=r)*t*((n+1)*t-n)+e},t.back.co=function(t,e,i,r,n){return n=1.70158,i*((t=t/r-1)*t*((n+1)*t+n)+1)+e},t}),define("scripts/lib/ucren.js",function(exports){var Ucren,blankArray=[],slice=blankArray.slice,join=blankArray.join;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/,"")}),String.prototype.format=function(t){var e=this;return Ucren.each(t,function(t,i){t=t.toString().replace(/\$/g,"$$$$"),e=e.replace(RegExp("@{"+i+"}","g"),t)}),e.toString()},String.prototype.htmlEncode=function(){var t=document.createElement("div");return function(){var e;return t.appendChild(document.createTextNode(this)),e=t.innerHTML,t.innerHTML="",e}}(),String.prototype.byteLength=function(){return this.replace(/[^\x00-\xff]/g,"  ").length},String.prototype.subByte=function(t,e){var i=this;return i.byteLength()<=t?i:(e=e||"",t-=e.byteLength(),i=i.slice(0,t).replace(/([^\x00-\xff])/g,"$1 ").slice(0,t).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"$1")+e)},Function.prototype.defer=function(t,e){var i=this,r=function(){i.apply(t,arguments)};return setTimeout(r,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;return function(){return e.apply(t,arguments)}}),Function.prototype.saturate=function(t){var e=this,i=slice.call(arguments,1);return function(){return e.apply(t,slice.call(arguments,0).concat(i))}},Array.prototype.indexOf=function(t,e){var i=this.length;for(e||(e=0),0>e&&(e=i+e);i>e;e++)if(this[e]===t)return e;return-1},Array.prototype.every=function(t,e){for(var i=0,r=this.length;r>i;i++)if(!t.call(e,this[i],i,this))return!1;return!0},Array.prototype.filter=function(t,e){for(var i,r=[],n=0,s=this.length;s>n;n++)i=this[n],t.call(e,i,n,this)&&r.push(i);return r},Array.prototype.forEach=function(t,e){for(var i=0,r=this.length;r>i;i++)t.call(e,this[i],i,this)},Array.prototype.map=function(t,e){for(var i=[],r=0,n=this.length;n>r;r++)i[r]=t.call(e,this[r],r,this);return i},Array.prototype.some=function(t,e){for(var i=0,r=this.length;r>i;i++)if(t.call(e,this[i],i,this))return!0;return!1},Array.prototype.invoke=function(t){var e=slice.call(arguments,1);return this.forEach(function(i){i instanceof Array?i[0][t].apply(i[0],i.slice(1)):i[t].apply(i,e)}),this},Array.prototype.random=function(){for(var t=this.slice(0),e=[],i=t.length;i--;)e.push(t.splice(Ucren.randomNumber(i+1),1)[0]);return e},Ucren={isIe:/msie/i.test(navigator.userAgent),isIe6:/msie 6/i.test(navigator.userAgent),isFirefox:/firefox/i.test(navigator.userAgent),isSafari:/version\/[\d\.]+\s+safari/i.test(navigator.userAgent),isOpera:/opera/i.test(navigator.userAgent),isChrome:/chrome/i.test(navigator.userAgent),isStrict:"CSS1Compat"==document.compatMode,tempDom:document.createElement("div"),apply:function(t,e,i){return e||(e={}),i?Ucren.each(t,function(t,r){r in i||(e[r]=t)}):Ucren.each(t,function(t,i){e[i]=t}),e},appendStyle:function(t){var e;arguments.length>1&&(t=join.call(arguments,"")),document.createStyleSheet?(e=document.createStyleSheet(),e.cssText=t):(e=document.createElement("style"),e.type="text/css",e.appendChild(document.createTextNode(t)),document.getElementsByTagName("head")[0].appendChild(e))},addEvent:function(t,e,i){var r=function(){i.apply(t,arguments)};return t.dom&&(t=t.dom),window.attachEvent?t.attachEvent("on"+e,r):window.addEventListener?t.addEventListener(e,r,!1):t["on"+e]=r,r},delEvent:function(t,e,i){window.detachEvent?t.detachEvent("on"+e,i):window.removeEventListener?t.removeEventListener(e,i,!1):t["on"+e]==i&&(t["on"+e]=null)},Class:function(t,e,i,r){var n,s,o;return t=t||function(){},e=e||{},o={},n=function(){this.instanceId=Ucren.id(),t.apply(this,arguments)},s=n.prototype,Ucren.registerClassEvent.call(s),Ucren.each(e,function(t,e){s[e]=function(t,e){return"function"==typeof t?function(){var n,s;return n=slice.call(arguments,0),i&&i.apply(this,[e].concat(n))===!1?void 0:(this.fireEvent("before"+e,n),s=t.apply(this,n),r&&r.apply(this,[e].concat(n)),this.fireEvent(e,n),s)}:t}(t,e)}),s.getOriginMethod=function(t){return e[t]},n},registerClassEvent:function(){this.on=function(t,e){var i=this.instanceId;Ucren.dispatch(i+t,e.bind(this))},this.onbefore=function(t,e){var i=this.instanceId;Ucren.dispatch(i+"before"+t,e.bind(this))},this.un=function(t,e){},this.fireEvent=function(t,e){var i=this.instanceId;Ucren.dispatch(i+t,e)}},createFuze:function(){var t,e,i;return t=[],e=function(e){i?e():t.push(e)},e.fire=function(){for(;t.length;)t.shift()();i=!0},e.extinguish=function(){i=!1},e.wettish=function(){t.length&&t.shift()()},e},dispatch:function(){var t,e,i={};return t=function(t,e,r){var n;(n=i[t])&&Ucren.each(n,function(t){t.apply(r,e)})},e=function(t,e){i[t]||(i[t]=[]),i[t].push(e)},function(i,r,n){"undefined"==typeof r&&(r=[]),r instanceof Array?t.apply(this,arguments):"function"==typeof r&&e.apply(this,arguments)}}(),each:function(t,e){if(t instanceof Array||"object"==typeof t&&"undefined"!=typeof t[0]&&t.length)"object"==typeof t&&Ucren.isSafari&&(t=slice.call(t)),t.forEach(e);else if("object"==typeof t){var i={};for(var r in t)if(!i[r]&&e(t[r],r)===!1)break}else if("number"==typeof t)for(var r=0;t>r&&e(r,r)!==!1;r++);else if("string"==typeof t)for(var r=0,n=t.length;n>r&&e(t.charAt(r),r)!==!1;r++);},Element:function(t,e){var i,r;return t&&t.isUcrenElement?e?t.dom:t:(t="string"==typeof t?document.getElementById(t):t)?e?t:(r=t.getAttribute("handleId"),"string"==typeof r?Ucren.handle(r-0):(i=new Ucren.BasicElement(t),r=Ucren.handle(i),t.setAttribute("handleId",r+""),i)):null},Event:function(t){if(t=t||window.event,!t)for(var e=arguments.callee.caller;e&&(t=e.arguments[0],!t||"boolean"!=typeof t.altKey);)e=e.caller,t=null;return t},fixNumber:function(t,e){
return"number"==typeof t?t:e},fixString:function(t,e){return"string"==typeof t?t:e},fixConfig:function(t){var e;return e={},"undefined"==typeof t?e:"function"==typeof t?new t:t},handle:function(t){var e,i,r;return e=arguments.callee,e.cache||(e.cache={}),"undefined"==typeof e.number&&(e.number=0),i=typeof t,"number"==i?e.cache[t.toString()]:"object"==i||"function"==i?(r=e.number++,e.cache[r.toString()]=t,r):void 0},id:function(){var t=arguments.callee;return t.number=++t.number||0,"_"+t.number},loadImage:function(t,e){var i=t.length,r=0,n=function(){r==i&&e&&e()};Ucren.each(t,function(t){var e=document.createElement("img");e.onload=e.onerror=function(){this.onload=this.onerror=null,r++,n()},Ucren.tempDom.appendChild(e),e.src=t})},loadScript:function(src,callback){Ucren.request(src,function(text){eval(text),callback&&callback(text)})},makeElement:function(t,e){var i=document.createElement(t),r=function(t){"string"==typeof t?i.style.cssText=t:Ucren.apply(t,i.style)};for(var n in e)"class"===n?i.className=e[n]:"for"===n?i.htmlFor=e[n]:"style"===n?r(e[n]):i.setAttribute(n,e[n]);return i},nul:function(){return!1},randomNumber:function(t){return Math.floor(Math.random()*t)},randomWord:function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";return function(e,i){var r,n=[];return r=i||t,Ucren.each(e,function(t){n[t]=r.charAt(this.randomNumber(r.length))}.bind(this)),n.join("")}}(),request:function(t,e){request=Ucren.request;var i=request.xhr;request.xhr||(i=window.XMLHttpRequest?request.xhr=new XMLHttpRequest:request.xhr=new ActiveXObject("Microsoft.XMLHTTP")),i.open("GET",t,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&e(i.responseText)},i.send(null)}},Ucren.BasicDrag=Ucren.Class(function(t){t=Ucren.fixConfig(t),this.type=Ucren.fixString(t.type,"normal");var e=this.isTouch="ontouchstart"in window;this.TOUCH_START=e?"touchstart":"mousedown",this.TOUCH_MOVE=e?"touchmove":"mousemove",this.TOUCH_END=e?"touchend":"mouseup"},{bind:function(t,e){t=Ucren.Element(t),e=Ucren.Element(e)||t;var i={};i[this.TOUCH_START]=function(t){return t=Ucren.Event(t),this.startDrag(),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),t.returnValue=!1}.bind(this),e.addEvents(i),this.target=t},getCoors:function(t){var e=[];if(t.targetTouches&&t.targetTouches.length){var i=t.targetTouches[0];e[0]=i.clientX,e[1]=i.clientY}else e[0]=t.clientX,e[1]=t.clientY;return e},startDrag:function(){var t,e,i;t=this.target,e=t.draging={},this.isDraging=!0,e.x=parseInt(t.style("left"),10)||0,e.y=parseInt(t.style("top"),10)||0,i=Ucren.Event();var r=this.getCoors(i);e.mouseX=r[0],e.mouseY=r[1],this.registerDocumentEvent()},endDrag:function(){this.isDraging=!1,this.unRegisterDocumentEvent()},registerDocumentEvent:function(){var t,e;t=this.target,e=t.draging,e.documentSelectStart=Ucren.addEvent(document,"selectstart",function(t){return t=t||event,t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1}),e.documentMouseMove=Ucren.addEvent(document,this.TOUCH_MOVE,function(t){var i,r;t=t||event,i=Ucren.isIe&&1!=t.button,r=!Ucren.isIe&&0!=t.button,!i&&!r||this.isTouch||this.endDrag();var n=this.getCoors(t);return e.newMouseX=n[0],e.newMouseY=n[1],t.stopPropagation&&t.stopPropagation(),t.returnValue=!1}.bind(this)),e.documentMouseUp=Ucren.addEvent(document,this.TOUCH_END,function(){this.endDrag()}.bind(this)),clearInterval(e.timer),e.timer=setInterval(function(){var i,r,n,s;e.newMouseX&&(n=e.newMouseX-e.mouseX,s=e.newMouseY-e.mouseY,i=e.x+n,r=e.y+s,"calc"==this.type?this.returnValue(n,s,e.newMouseX,e.newMouseY):t.left(i).top(r))}.bind(this),10)},unRegisterDocumentEvent:function(){var t=this.target.draging;Ucren.delEvent(document,this.TOUCH_MOVE,t.documentMouseMove),Ucren.delEvent(document,this.TOUCH_END,t.documentMouseUp),Ucren.delEvent(document,"selectstart",t.documentSelectStart),clearInterval(t.timer)},returnValue:function(t,e,i,r){}}),Ucren.Template=Ucren.Class(function(){this.string=join.call(arguments,"")},{apply:function(t){return this.string.format(t)}}),Ucren.BasicElement=Ucren.Class(function(t){this.dom=t,this.countMapping={}},{isUcrenElement:!0,attr:function(t,e){return"string"!=typeof e?this.dom.getAttribute(t):(this.dom.setAttribute(t,e),this)},style:function(){var t=Ucren.isIe?function(t){return this.dom.currentStyle[t]}:function(t){var e;return e=document.defaultView.getComputedStyle(this.dom,null),e.getPropertyValue(t)};return function(e,i){if("object"==typeof e)Ucren.each(e,function(t,e){this[e]=t}.bind(this.dom.style));else{if("string"==typeof e&&"undefined"==typeof i)return t.call(this,e);"string"==typeof e&&"undefined"!=typeof i&&(this.dom.style[e]=i)}return this}}(),hasClass:function(t){var e=" "+this.dom.className+" ";return e.indexOf(" "+t+" ")>-1},setClass:function(t){return"string"==typeof t&&(this.dom.className=t.trim()),this},addClass:function(t){var e,i;return e=this.dom,i=" "+e.className+" ",-1==i.indexOf(" "+t+" ")&&(i+=t,i=i.trim(),i=i.replace(/ +/g," "),e.className=i),this},delClass:function(t){var e,i;return e=this.dom,i=" "+e.className+" ",i.indexOf(" "+t+" ")>-1&&(i=i.replace(" "+t+" "," "),i=i.trim(),i=i.replace(/ +/g," "),e.className=i),this},html:function(t){var e=this.dom;if("string"==typeof t)e.innerHTML=t;else{if(!(t instanceof Array))return e.innerHTML;e.innerHTML=t.join("")}return this},left:function(t){var e=this.dom;return"number"!=typeof t?this.getPos().x:(e.style.left=t+"px",this.fireEvent("infect",[{left:t}]),this)},top:function(t){var e=this.dom;return"number"!=typeof t?this.getPos().y:(e.style.top=t+"px",this.fireEvent("infect",[{top:t}]),this)},width:function(t){var e=this.dom;if("number"==typeof t)e.style.width=t+"px",this.fireEvent("infect",[{width:t}]);else{if("string"!=typeof t)return this.getSize().width;e.style.width=t,this.fireEvent("infect",[{width:t}])}return this},height:function(t){var e=this.dom;if("number"==typeof t)e.style.height=t+"px",this.fireEvent("infect",[{height:t}]);else{if("string"!=typeof t)return this.getSize().height;e.style.height=t,this.fireEvent("infect",[{height:t}])}return this},count:function(t){return this.countMapping[t]=++this.countMapping[t]||1},display:function(t){var e=this.dom;return"boolean"!=typeof t?"none"!=this.style("display"):(e.style.display=t?"block":"none",this.fireEvent("infect",[{display:t}]),this)},first:function(){for(var t=this.dom.firstChild;t&&!t.tagName&&t.nextSibling;)t=t.nextSibling;return t},add:function(t){var e;return e=Ucren.Element(t),this.dom.appendChild(e.dom),this},remove:function(t){var e;return t?(e=Ucren.Element(t),e.html(""),this.dom.removeChild(e.dom)):(e=Ucren.Element(this.dom.parentNode),e.remove(this)),this},insert:function(t){var e;return e=this.dom,e.firstChild?e.insertBefore(t,e.firstChild):this.add(t),this},addEvents:function(t){var e,i,r;return e={},r={},i=this.dom,Ucren.each(t,function(t,e){r[e]=Ucren.addEvent(i,e,t)}),r},removeEvents:function(t){var e,i;return e={},i=this.dom,Ucren.each(t,function(t,e){Ucren.delEvent(i,e,t)}),this},getPos:function(){var t,e,i,r,n;if(t=this.dom,i={},t.getBoundingClientRect){r=t.getBoundingClientRect(),n=Ucren.isIe?2:0;var s=document,o=Math.max(s.documentElement.scrollTop,s.body.scrollTop),a=Math.max(s.documentElement.scrollLeft,s.body.scrollLeft);return{x:r.left+a-n,y:r.top+o-n}}if(i={x:t.offsetLeft,y:t.offsetTop},e=t.offsetParent,e!=t)for(;e;)i.x+=e.offsetLeft,i.y+=e.offsetTop,e=e.offsetParent;for(Ucren.isSafari&&"absolute"==this.style("position")&&(i.x-=document.body.offsetLeft,i.y-=document.body.offsetTop),e=t.parentNode?t.parentNode:null;e&&"BODY"!=e.tagName.toUpperCase()&&"HTML"!=e.tagName.toUpperCase();)i.x-=e.scrollLeft,i.y-=e.scrollTop,e=e.parentNode?e.parentNode:null;return i},getSize:function(){var t=this.dom,e=this.style("display");if(e&&"none"!==e)return{width:t.offsetWidth,height:t.offsetHeight};var i=t.style,r={visibility:i.visibility,position:i.position,display:i.display},n={visibility:"hidden",display:"block"};"fixed"!==r.position&&(n.position="absolute"),this.style(n);var s={width:t.offsetWidth,height:t.offsetHeight};return this.style(r),s},observe:function(t,e){return t=Ucren.Element(t),t.on("infect",e.bind(this)),this},usePNGbackground:function(t){var e;return e=this.dom,/\.png$/i.test(t)&&Ucren.isIe6?e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t+"',sizingMethod='scale');":e.style.backgroundImage="url("+t+")",this},setAlpha:function(){var t=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/;return function(e){var i=this.dom,r=i.style;return Ucren.isIe?(i.currentStyle&&!i.currentStyle.hasLayout&&(r.zoom=1),t.test(r.filter)?(e=e>=99.99?"":"alpha(opacity="+e+")",r.filter=r.filter.replace(t,e)):r.filter+=" alpha(opacity="+e+")"):r.opacity=e/100,this}}(),fadeIn:function(t){"undefined"==typeof this.fadingNumber&&(this.fadingNumber=0),this.setAlpha(this.fadingNumber);var e=function(){this.setAlpha(this.fadingNumber),100==this.fadingNumber?(clearInterval(this.fadingInterval),t&&t()):this.fadingNumber+=10}.bind(this);return this.display(!0),clearInterval(this.fadingInterval),this.fadingInterval=setInterval(e,Ucren.isIe?20:30),this},fadeOut:function(t){"undefined"==typeof this.fadingNumber&&(this.fadingNumber=100),this.setAlpha(this.fadingNumber);var e=function(){this.setAlpha(this.fadingNumber),0==this.fadingNumber?(clearInterval(this.fadingInterval),this.display(!1),t&&t()):this.fadingNumber-=10}.bind(this);return clearInterval(this.fadingInterval),this.fadingInterval=setInterval(e,Ucren.isIe?20:30),this},useMouseAction:function(t,e){return this.MouseAction||(this.MouseAction=new Ucren.MouseAction({element:this})),this.MouseAction.use(t,e),this}}),Ucren.isIe&&document.execCommand("BackgroundImageCache",!1,!0);for(var i in Ucren)exports[i]=Ucren[i];return exports}),define("scripts/object/background.js",function(t){function e(){var t,e;t=a(12)-6,e=a(12)-6,i.attr({x:t,y:e})}var i,r,n=require("scripts/lib/ucren"),s=require("scripts/layer"),o=require("scripts/timeline"),a=n.randomNumber;return t.set=function(){i=s.createImage("default","images/background.jpg",0,0,640,480)},t.wobble=function(){r=o.setInterval(e,50)},t.stop=function(){r.stop(),i.attr({x:0,y:0})},t}),define("scripts/object/console.js",function(t){var e=require("scripts/layer"),i=16,r=0,n=[];return t.set=function(){},t.clear=function(){for(var t=0,e=n.length;e>t;t++)n[t].remove();n.length=r=0},t.log=function(t){r+=20,n.push(e.createText("default",t,i,r))},t}),define("scripts/object/developing.js",function(t){var e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),n=(require("scripts/message"),i.exponential.co);return t.anims=[],t.set=function(){this.image=e.createImage("default","images/developing.png",103,218,429,53).hide().scale(1e-5,1e-5)},t.show=function(t){r.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims}),this.hide(2e3)},t.hide=function(t){r.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.onZoomStart=function(){this.image.show()},t.onZooming=function(t,e,i,r){this.image.scale(r=n(t,e,i-e,500),r)},t.onZoomEnd=function(t,e,i){"hide"===i&&this.image.hide()},t}),define("scripts/object/dojo.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/dojo.png",41,240,175,175,1e-5,i.exponential.co,500)}),define("scripts/object/flame.js",function(t){function e(t,e,i,r,s){return s[p]={id:p++,birthday:new Date,center:t,angle:e,length:i,life:r,path:n.path().attr({stroke:"none",fill:h(180*e/f)+"-#fafad9-#f0ef9c"})}}function i(t,e){var i=t[e];if(i){var r,n,s,o,a,l;if(r=1-(new Date-i.birthday)/i.life,0>=r)return i.path.remove(),void delete t[i.id];var p,m,g;p=i.angle,m=i.center,g=i.length,n=[h(m[0]+c(p)*g*(1-r)),h(m[1]+u(p)*g*(1-r))],s=[h(n[0]-c(p)*d*r),h(n[1]-u(p)*d*r)],o=[h(n[0]+c(p)*d*r),h(n[1]+u(p)*d*r)],a=[h(n[0]-c(p+.5*f)*d*.4*r),h(n[1]-u(p+.5*f)*d*.4*r)],l=[h(n[0]-c(p-.5*f)*d*.4*r),h(n[1]-u(p-.5*f)*d*.4*r)],i.path.attr({path:"M"+s+" Q"+[a,o,l,s].join(" ")})}}function r(t,e){var i=t[e];i&&(i.path.remove(),delete t[e])}var n=require("scripts/layer").getLayer("fruit"),s=require("scripts/timeline"),o=require("scripts/lib/ucren"),a=Math,c=a.cos,u=a.sin,h=parseInt,l=a.random,f=a.PI,p=0,d=15;return t.create=function(t,a,c){var u,h,p={pos:function(t,e){d=t,m=e,g.attr("x",d-21).attr("y",m-21)},remove:function(){[u,h].invoke("stop"),g.remove();for(var t in v)r(v,t)}},d=t,m=a,g=n.image("images/smoke.png",d-21,m-21,43,43).hide(),v={};return u=s.setTimeout(function(){g.show(),h=s.setInterval(function(){l()<.9&&e([d,m],2*f*l(),60,200+500*l(),v);for(var t in v)i(v,t)},o.isIe?20:40)},c||0),p},t}),define("scripts/object/flash.js",function(t){var e,i,r=require("scripts/layer"),n=require("scripts/timeline"),s=require("scripts/lib/tween"),o=require("scripts/lib/ucren"),a=require("scripts/lib/sound"),c=0,u=0,h=s.quadratic.cio,l=[],f=100,p=!0;return t.set=p?function(){e=r.createImage("flash","images/flash.png",0,0,358,20).hide(),i=a.create("sound/splatter")}:o.nul,t.showAt=p?function(t,r,s){e.rotate(s,!0).scale(1e-5,1e-5).attr({x:t+c,y:r+u}).show(),l.clear&&l.clear(),i.play(),n.createTask({start:0,duration:f,data:[1e-5,1],object:this,onTimeUpdate:this.onTimeUpdate,recycle:l}),n.createTask({start:f,duration:f,data:[1,1e-5],object:this,onTimeUpdate:this.onTimeUpdate,recycle:l})}:o.nul,t.onTimeUpdate=p?function(t,i,r,n){e.scale(n=h(t,i,r-i,f),n)}:o.nul,t}),define("scripts/object/fps.js",function(t){var e,i=require("scripts/layer"),r=require("scripts/timeline"),n="fps: ";return t.set=function(){e=i.createText("default",n+"0",4,470).attr("fill","#ccc")},t.update=function(){e.attr("text",n+(r.getFPS()>>0))},t}),define("scripts/object/game-over.js",function(t){var e=require("scripts/layer"),i=require("scripts/lib/tween"),r=require("scripts/timeline"),n=(require("scripts/message"),require("scripts/state")),s=i.exponential.co;return t.anims=[],t.set=function(){this.image=e.createImage("default","images/game-over.png",75,198,490,85).hide().scale(1e-5,1e-5)},t.show=function(t){r.createTask({start:t,duration:500,data:[1e-5,1,"show"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.hide=function(t){r.createTask({start:t,duration:500,data:[1,1e-5,"hide"],object:this,onTimeUpdate:this.onZooming,onTimeStart:this.onZoomStart,onTimeEnd:this.onZoomEnd,recycle:this.anims})},t.onZoomStart=function(t,e,i){"show"==i&&this.image.show()},t.onZooming=function(t,e,i,r){this.image.scale(r=s(t,e,i-e,500),r)},t.onZoomEnd=function(t,e,i){"show"==i?n("click-enable").on():"hide"===i&&this.image.hide()},t}),define("scripts/object/home-desc.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/home-desc.png",161,91,-161,140,7,127,i.exponential.co,500)}),define("scripts/object/home-mask.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/home-mask.png",640,183,0,-183,0,0,i.exponential.co,1e3)}),define("scripts/object/knife.js",function(t){function e(t){this.sx=t.sx,this.sy=t.sy,this.ex=t.ex,this.ey=t.ey,f.push(this)}var i=require("scripts/timeline"),r=require("scripts/layer").getLayer("knife"),n=(require("scripts/lib/ucren"),null),s=null,o=Math.abs,a=200,c=10,u="#cbd3db",h=[],l=!0,f=[];return e.prototype.set=function(){var t,e,n,s,l,f,p,d;return t=this.sx,e=this.sy,n=this.ex,s=this.ey,l=t-n,f=e-s,p=o(l),d=o(f),p>d?(t+=0>l?-1:1,e+=0>f?-(1*d/p):1*d/p):(t+=0>l?-(1*p/d):1*p/d,e+=0>f?-1:1),this.line=r.path("M"+t+","+e+"L"+n+","+s).attr({stroke:u,"stroke-width":c+"px"}),i.createTask({start:0,duration:a,object:this,onTimeUpdate:this.update,onTimeEnd:this.end,recycle:h}),this},e.prototype.update=function(t){this.line.attr("stroke-width",c*(1-t/a)+"px")},e.prototype.end=function(){this.line.remove();var t;(t=f.indexOf(this))&&f.splice(t,1)},t.newKnife=function(){n=s=null},t.through=function(t,i){if(l){var r=null;return null===n||n==t&&s==i||(new e({sx:n,sy:s,ex:t,ey:i}).set(),r=[n,s,t,i]),n=t,s=i,r}},t.pause=function(){h.clear(),this.switchOff()},t.switchOff=function(){l=!1},t.switchOn=function(){l=!0,this.endAll()},t.endAll=function(){for(var t=f.length-1;t>=0;t--)f[t].end()},t}),define("scripts/object/light.js",function(t){function e(t,e,r){var n,s,o,f,p,d;n=36*r+a(10),s=n+5,n=c*n/180,s=c*s/180,o=t+640*h(n),f=e+640*u(n),p=t+640*h(s),d=e+640*u(s);var m=i.path(["M",t,e,"L",o,f,"L",p,d,"Z"]).attr({stroke:"none",fill:"#fff"});l.push(m)}var i=require("scripts/layer"),r=i.getLayer("mask");i=i.getLayer("light");for(var n=require("scripts/lib/ucren"),s=require("scripts/timeline"),o=require("scripts/message"),a=n.randomNumber,c=Math.PI,u=Math.sin,h=Math.cos,l=[],f=[],p=10,d=0;p>d;d++)f[d]=d;return t.start=function(t){for(var i=t.originX,r=t.originY,n=0,o=f.random(),a=function(){e(i,r,o[this])},c=0;p>c;c++)s.setTimeout(a.bind(c),n+=200);s.setTimeout(function(){this.overWhiteLight()}.bind(this),n+200)},t.overWhiteLight=function(){o.postMessage("overWhiteLight.show"),this.removeLights();var t=4e3,e=r.rect(0,0,640,480).attr({fill:"#fff",stroke:"none"}),i={onTimeUpdate:function(i){e.attr("opacity",1-i/t)},onTimeEnd:function(){e.remove(),o.postMessage("game.over")}};s.createTask({start:0,duration:t,object:i,onTimeUpdate:i.onTimeUpdate,onTimeEnd:i.onTimeEnd})},t.removeLights=function(){for(var t=0,e=l.length;e>t;t++)l[t].remove();l.length=0},t}),define("scripts/object/logo.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/logo.png",288,135,17,-182,17,1,i.exponential.co,1e3)}),define("scripts/object/lose.js",function(t){function e(t){var e=s.createImage("default","images/lose.png",t-27,406,54,50).scale(1e-5,1e-5),i=500,r={show:function(t){a.createTask({start:t,duration:i,data:[o.back.co,1e-5,1],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onShowEnd})},hide:function(t){a.createTask({start:t,duration:i,data:[o.back.ci,1,1e-5],object:this,onTimeUpdate:this.onScaling,onTimeEnd:this.onHideEnd})},onScaling:function(t,r,n,s,o){e.scale(o=r(t,n,s-n,i),o)},onShowEnd:function(){this.hide(1500)},onHideEnd:function(){e.remove()}};r.show(200)}var i,r,n,s=require("scripts/layer"),o=require("scripts/lib/tween"),a=require("scripts/timeline"),c=(require("scripts/lib/ucren"),require("scripts/message")),u=o.exponential.co,h=o.back.co,l=500,f={src:"images/x.png",sx:650,ex:561,y:5,w:22,h:19},p={src:"images/xx.png",sx:671,ex:582,y:5,w:27,h:26},d={src:"images/xxx.png",sx:697,ex:608,y:6,w:31,h:32},m=0;return t.anims=[],t.set=function(){i=s.createImage("default",f.src,f.sx,f.y,f.w,f.h).hide(),r=s.createImage("default",p.src,p.sx,p.y,p.w,p.h).hide(),n=s.createImage("default",d.src,d.sx,d.y,d.w,d.h).hide()},t.show=function(t){a.createTask({start:t,duration:l,data:["show",f.sx,f.ex,p.sx,p.ex,d.sx,d.ex],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.hide=function(t){a.createTask({start:t,duration:l,data:["hide",f.ex,f.sx,p.ex,p.sx,d.ex,d.sx],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.showLoseAt=function(t){var s,o=[[i,f],[r,p],[n,d]];e(t),s=o[++m-1],s[0].attr("src",s[1].src.replace("x.png","xf.png")).scale(1e-5,1e-5),this.scaleImage(s[0]),3==m&&(m=0,c.postMessage("game.over"))},t.scaleImage=function(t){var e=500;t.myOnScaling=t.myOnScaling||function(t,i){this.scale(i=h(t,1e-5,.99999,e),i)},t.myOnScaleEnd=t.myOnScaleEnd||function(){this.scale(1,1)},a.createTask({start:0,duration:e,object:t,onTimeUpdate:t.myOnScaling,onTimeEnd:t.myOnScaleEnd,recycle:this.anims})},t.onTimeUpdate=function(t,e,s,o,a,c,h,f){i.attr("x",u(t,s,o-s,l)),r.attr("x",u(t,a,c-a,l)),n.attr("x",u(t,h,f-h,l))},t.onTimeStart=function(t){"show"==t&&[i,r,n].invoke("show")},t.onTimeEnd=function(t){"hide"==t&&([i,r,n].invoke("hide"),[[i,f],[r,p],[n,d]].forEach(function(t){t[0].attr("src",t[1].src.replace("xf.png","x.png"))}))},t}),define("scripts/object/new-game.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/new-game.png",244,231,195,195,1e-5,i.exponential.co,500)}),define("scripts/object/new.js",function(t){var e,i=require("scripts/layer"),r=require("scripts/lib/tween"),n=require("scripts/timeline"),s=(require("scripts/lib/ucren"),300),o=129,a=328,c=170,u=221,h=0,l=0,f=70,p=42,d=8,m=r.exponential.co,g=r.quadratic.ci;return t.anims=[],t.set=function(){e=i.createImage("default","images/new.png",o,a,h,l)},t.unset=function(){},t.show=function(t){n.createTask({start:t,duration:500,data:[o,c,a,u,h,f,l,p],object:this,onTimeUpdate:this.onShowing,onTimeStart:this.onShowStart,onTimeEnd:this.onShowEnd,recycle:this.anims})},t.hide=function(t){this.anims.clear(),n.createTask({start:t,duration:500,data:[c,o,u,a,f,h,p,l],object:this,onTimeUpdate:this.onShowing,recycle:this.anims})},t.jump=function(){this.anims.clear(),n.createTask({start:0,duration:-1,object:this,onTimeUpdate:this.onJumping,recycle:this.anims})},t.onShowStart=function(){},t.onShowing=function(t,i,r,n,s,o,a,c,u){e.attr({x:m(t,i,r-i,500),y:m(t,n,s-n,500),width:m(t,o,a-o,500),height:m(t,c,u-c,500)})},t.onShowEnd=function(){this.jump()},t.onJumping=function(t){var i=parseInt(t/s);t%=s,i%2&&(t=s-t),e.attr("y",g(t,u,d,s))},t}),define("scripts/object/ninja.js",function(t){var e=require("scripts/factory/displacement"),i=require("scripts/lib/tween");return t=e.create("images/ninja.png",244,81,315,-140,315,43,{show:i.bounce.co,hide:i.exponential.co},1e3)}),define("scripts/object/quit.js",function(t){var e=require("scripts/factory/rotate"),i=require("scripts/lib/tween");return t=e.create("images/quit.png",493,311,141,141,1e-5,i.exponential.co,500)}),define("scripts/object/score.js",function(t){var e,i,r,n=require("scripts/layer"),s=require("scripts/lib/tween"),o=require("scripts/timeline"),a=(require("scripts/lib/ucren"),o.setTimeout.bind(o)),c=s.exponential.co,u=(require("scripts/message"),500),h=-94,l=6,f=-59,p=41,d=-93,m=7;return t.anims=[],t.set=function(){e=n.createImage("default","images/score.png",h,8,29,31).hide(),i=n.createText("default","0",f,24,"90-#fc7f0c-#ffec53","30px").hide(),r=n.createText("default","BEST 999",d,48,"#af7c05","14px").hide()},t.show=function(t){o.createTask({start:t,duration:u,data:["show",h,l,f,p,d,m],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.hide=function(t){o.createTask({start:t,duration:u,data:["hide",l,h,p,f,m,d],object:this,onTimeUpdate:this.onTimeUpdate,onTimeStart:this.onTimeStart,onTimeEnd:this.onTimeEnd,recycle:this.anims})},t.number=function(t){i.attr("text",t||0),e.scale(1.2,1.2),a(function(){e.scale(1,1)},60)},t.onTimeUpdate=function(t,n,s,o,a,h,l,f){e.attr("x",c(t,s,o-s,u)),i.attr("x",c(t,a,h-a,u)),r.attr("x",c(t,l,f-l,u))},t.onTimeStart=function(t){"show"===t&&[e,i,r].invoke("show")},t.onTimeEnd=function(t){"hide"===t&&([e,i,r].invoke("hide"),i.attr("text",0))},t}),startModule("scripts/main");